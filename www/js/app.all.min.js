!function(){"use strict";angular.module("app",["ionic","applicat.push.service","ngCordova","ngResource","ngTemplates","ngStorage","ngFileUpload","ngGeolocation"]).run(["$ionicPlatform","$rootScope","$state","$window","$ionicHistory","Message","rootScopeService","appStorage","devMode","PushService",function($ionicPlatform,$rootScope,$state,$window,$ionicHistory,Message,rootScopeService,appStorage,devMode,PushService){function onIonicPlatformReady(){$window.cordova&&$window.cordova.plugins.Keyboard&&$window.cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),$window.StatusBar&&$window.StatusBar.styleDefault(),$window.cordova&&PushService.registerDevice(),$ionicPlatform.registerBackButtonAction(function(e){return e.preventDefault(),$rootScope.areStates(["main.productList.market","main.productList.pawnShop","main.walkThrough","main.login"])?ionic.Platform.exitApp():void $ionicHistory.goBack()},101),setInitialState()}function setInitialState(){appStorage.address="전체보기",appStorage.geoJSON||(appStorage.geoJSON={type:"Point",coordinates:[127.02800027507125,37.498085435791786]},appStorage.marketDistance=3e4,appStorage.pawnShopDistance=3e4),$rootScope.appStorage.firstTime&&$state.get("main.walkThrough")?$state.go("main.walkThrough"):$rootScope.appStorage.token?$state.go("main.productList.pawnShop",{category:"pawnShop",status:"responded",product:"",to:"",method:"create",id:"",step:2}):$state.go("main.login")}angular.extend($rootScope,rootScopeService),$ionicPlatform.ready(onIonicPlatformReady),devMode&&setInitialState()}]).config(["$stateProvider","$httpProvider",function($stateProvider,$httpProvider){$httpProvider.interceptors.push("AuthInterceptor"),$stateProvider.state("main",{url:"/main",templateUrl:"state/00main/main.html",controller:"MainController as Main"}).state("main.walkThrough",{url:"/walkThrough",views:{main:{templateUrl:"state/01walkThrough/walkThrough.html",controller:"WalkThroughController as WalkThrough"}}}).state("main.login",{url:"/login",views:{main:{templateUrl:"state/02login/login.html",controller:"LoginController as Login"}}}).state("main.signUp",{params:{category:""},url:"/signUp",views:{main:{templateUrl:"state/02signUp/signUp.html",controller:"SignUpController as SignUp"}}}).state("main.resetPassword",{params:{category:""},url:"/resetPassword",views:{main:{templateUrl:"state/02resetPassword/resetPassword.html",controller:"ResetPasswordController as ResetPassword"}}}).state("main.profile",{params:{category:"",id:""},url:"/profile",views:{main:{templateUrl:"state/03profile/profile.html",controller:"ProfileController as Profile"}}}).state("main.customer",{url:"/customer",views:{main:{templateUrl:"state/04customer/customer.html",controller:"CustomerController as Customer"}}}).state("main.term",{url:"/term",views:{main:{templateUrl:"state/04term/term.html",controller:"TermDetailController as TermDetail"}}}).state("main.home",{url:"/home",views:{main:{templateUrl:"state/09home/home.html",controller:"HomeController as Home"}}}).state("main.bidListUser",{params:{category:"user",product:""},url:"/bidListUser",views:{main:{templateUrl:"state/10bidList/user/bidListUser.html",controller:"BidListUserController as BidListUser"}}}).state("main.bidDetailUser",{params:{id:""},url:"/bidDetailUser",views:{main:{templateUrl:"state/10bidDetail/user/bidDetailUser.html",controller:"BidDetailUserController as BidDetailUser"}}}).state("main.bidListPawnShopPending",{params:{category:"pawnShop",status:"pending"},url:"/bidListPawnShopPending",views:{main:{templateUrl:"state/10bidList/pawnShop/pending/bidListPawnShopPending.html",controller:"BidListPawnShopPendingController as BidListPawnShopPending"}}}).state("main.bidDetailPawnShopPending",{params:{id:""},url:"/bidDetailPawnShopPending",views:{main:{templateUrl:"state/10bidDetail/pawnShop/pending/bidDetailPawnShopPending.html",controller:"BidDetailPawnShopPendingController as BidDetailPawnShopPending"}}}).state("main.bidListPawnShopResponded",{params:{category:"pawnShop",status:"responded"},url:"/bidListPawnShopResponded",views:{main:{templateUrl:"state/10bidList/pawnShop/responded/bidListPawnShopResponded.html",controller:"BidListPawnShopRespondedController as BidListPawnShopResponded"}}}).state("main.bidDetailPawnShopResponded",{params:{id:""},url:"/bidDetailPawnShopResponded",views:{main:{templateUrl:"state/10bidDetail/pawnShop/responded/bidDetailPawnShopResponded.html",controller:"BidDetailPawnShopRespondedController as BidDetailPawnShopResponded"}}}).state("main.favoriteProductList",{url:"/favoriteProductList",views:{main:{templateUrl:"state/10favoriteProductList/favoriteProductList.html",controller:"FavoriteProductListController as FavoriteProductList"}}}).state("main.favoriteProductDetail",{url:"/favoriteProductDetail",views:{main:{templateUrl:"state/10favoriteProductDetail/favoriteProductDetail.html",controller:"FavoriteProductDetailController as FavoriteProductDetail"}}}).state("main.myProductListUser",{params:{category:"user"},url:"/myProductListUser",views:{main:{templateUrl:"state/10myProductList/user/myProductListUser.html",controller:"MyProductListUserController as MyProductListUser"}}}).state("main.myProductListPawnShop",{params:{category:"pawnShop"},url:"/myProductListPawnShop",views:{main:{templateUrl:"state/10myProductList/pawnShop/myProductListPawnShop.html",controller:"MyProductListPawnShopController as MyProductListPawnShop"}}}).state("main.productList",{url:"/productList",views:{main:{templateUrl:"state/10productList/productList.html",controller:"ProductListController as ProductList"}}}).state("main.productList.market",{params:{category:"",id:""},url:"/market",views:{productList:{templateUrl:"state/10productList/market/market.html",controller:"ProductListController as ProductList"}}}).state("main.productList.pawnShop",{params:{category:"",id:""},url:"/pawnShop",views:{productList:{templateUrl:"state/10productList/pawnShop/pawnShop.html",controller:"ProductListController as ProductList"}}}).state("main.placeId",{params:{category:"",id:""},url:"/placeId",views:{main:{templateUrl:"state/10productList/placeId/placeId.html",controller:"ProductListController as ProductList"}}}).state("main.productRegister",{url:"/productRegister",views:{main:{templateUrl:"state/10productRegister/productRegister.html",controller:"ProductRegisterController as ProductRegister"}}}).state("main.productRegister.step1",{params:{category:"",step:"",id:"",method:""},url:"/step1",views:{productRegister:{templateUrl:"state/10productRegister/content/step1.html",controller:"ProductRegisterController as ProductRegister"}}}).state("main.productRegister.step2",{params:{category:"",step:"",id:"",method:""},url:"/step2",views:{productRegister:{templateUrl:"state/10productRegister/content/step2.html",controller:"ProductRegisterController as ProductRegister"}}}).state("main.productUpdate",{url:"/productUpdate",views:{main:{templateUrl:"state/10productUpdate/productUpdate.html",controller:"ProductUpdateController as ProductUpdate"}}}).state("main.productUpdate.info",{params:{category:"",step:"",section:"info",id:"",method:""},url:"/info",views:{productUpdate:{templateUrl:"state/10productUpdate/info/productUpdateInfo.html",controller:"ProductUpdateInfoController as ProductUpdateInfo"}}}).state("main.productUpdate.photo",{params:{category:"",step:"",section:"photo",id:"",method:""},url:"/photo",views:{productUpdate:{templateUrl:"state/10productUpdate/photo/productUpdatePhoto.html",controller:"ProductUpdatePhotoController as ProductUpdatePhoto"}}}).state("main.productDetail",{url:"/productDetail",views:{main:{templateUrl:"state/10productDetail/productDetail.html",controller:"ProductDetailController as ProductDetail"}}}).state("main.productDetail.market",{params:{category:"",id:""},url:"/market",views:{productDetail:{templateUrl:"state/10productDetail/market/market.html",controller:"ProductDetailController as ProductDetail"}}}).state("main.productDetail.pawnShop",{params:{category:"",id:""},url:"/pawnShop",views:{productDetail:{templateUrl:"state/10productDetail/pawnShop/pawnShop.html",controller:"ProductDetailController as ProductDetail"}}}).state("main.postList",{params:{category:""},url:"/postList",views:{main:{templateUrl:"state/11postList/postList.html",controller:"PostListController as PostList"}}}).state("main.postDetail",{params:{id:""},url:"/postDetail",views:{main:{templateUrl:"state/11postDetail/postDetail.html",controller:"PostDetailController as PostDetail"}}}).state("main.announcementList",{params:{category:""},url:"/announcementList",views:{main:{templateUrl:"state/12announcementList/announcementList.html",controller:"AnnouncementListController as AnnouncementList"}}}).state("main.announcementDetail",{params:{category:"",id:""},url:"/announcementDetail",views:{main:{templateUrl:"state/12announcementDetail/announcementDetail.html",controller:"AnnouncementDetailController as AnnouncementDetail"}}}).state("main.faqList",{params:{category:""},url:"/faqList",views:{main:{templateUrl:"state/12faqList/faqList.html",controller:"FaqListController as FaqList"}}}).state("main.faqDetail",{params:{category:"",id:""},url:"/faqDetail",views:{main:{templateUrl:"state/12faqDetail/faqDetail.html",controller:"FaqDetailController as FaqDetail"}}}).state("main.placeList",{params:{category:""},url:"/placeList",views:{main:{templateUrl:"state/19placeList/placeList.html",controller:"PlaceListController as PlaceList"}}}).state("main.placeDetail",{params:{id:""},url:"/placeDetail",views:{main:{templateUrl:"state/19placeDetail/placeDetail.html",controller:"PlaceDetailController as PlaceDetail"}}}).state("main.daumMap",{params:{prev:"",id:""},url:"/daumMap",views:{main:{templateUrl:"state/20daumMap/daumMap.html",controller:"DaumMapController as DaumMap"}}})}])}(),function(){"use strict";angular.module("app").constant("governorUrl","http://52.192.13.221").constant("appName","ohShop").constant("appId",7).constant("googlePushSenderID","772851935175").constant("kakaoKey","bdb254de02ea0b7521635ba469608674").constant("facebookKey","801820753200919").constant("devMode",!1)}(),function(){"use strict";function Bids($resource,governorUrl){var bidUrl=governorUrl+"/bid/:findOne/:find/:create/:update/:destroy/:findOrCreate/:count",params={findOne:"@findOne",find:"@find",create:"@create",update:"@update",destroy:"@destroy",findOrCreate:"@findOrCreate",count:"@count"},actions={findOne:{method:"GET",params:{findOne:"findOne"}},find:{method:"GET",params:{find:"find"}},create:{method:"POST",params:{create:"create"}},update:{method:"PUT",params:{update:"update"}},destroy:{method:"DELETE",params:{destroy:"destroy"}},findOrCreate:{method:"POST",params:{findOrCreate:"findOrCreate"}},count:{method:"GET",params:{count:"count"}}},service=$resource(bidUrl,params,actions);return service}angular.module("app").factory("Bids",Bids),Bids.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Bookings($resource,governorUrl,$cordovaFileTransfer){var bookingUrl=governorUrl+"/booking/:list/:image/:mine/:dateBetween/:request",params={list:"@list",image:"@image",mine:"@mine",dateBetween:"@dateBetween"},actions={getBookings:{method:"GET",params:{list:"list"}},getMyBookings:{method:"GET",params:{list:"list",mine:"mine"}},getBookingsDateBetween:{method:"GET",params:{dateBetween:"dateBetween"}},findById:{method:"GET"},createBooking:{method:"POST"},requestBooking:{method:"POST",params:{request:"request"}},updateBooking:{method:"PUT",isArray:!0,headers:{"Content-Type":"text/plain"}},removeBooking:{method:"DELETE"}},service=$resource(bookingUrl,params,actions);return service.createBookingWithImage=function(parameters,booking){angular.extend(booking,parameters);var filePath=booking.file;delete booking.file;var options={params:booking,chunkedMode:!1};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/booking/image",filePath,options)}},service.updateBookingWithImage=function(parameters,booking){angular.extend(booking,parameters);var filePath=booking.file;delete booking.file;var options={params:booking,chunkedMode:!1,httpMethod:"PUT"};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/booking/image",filePath,options)}},service}angular.module("app").factory("Bookings",Bookings),Bookings.$inject=["$resource","governorUrl","$cordovaFileTransfer"]}(),function(){"use strict";function Comments($resource,governorUrl){var commentUrl=governorUrl+"/:post/:comment/:reply",params={post:"@post",comment:"@comment",reply:"@reply"},actions={addCommentToPost:{method:"POST",params:{post:"post",comment:"comment"}},reply:{method:"POST",params:{comment:"comment",reply:"reply"}},find:{method:"GET",params:{comment:"comment"},isArray:!0}},service=$resource(commentUrl,params,actions);return service}angular.module("app").factory("Comments",Comments),Comments.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Contacts($resource,governorUrl){var deviceUrl=governorUrl+"/:contact/:admin",params={contact:"@contact",admin:"@admin"},actions={contactAdmin:{method:"POST",params:{contact:"contact",admin:"admin"}}},service=$resource(deviceUrl,params,actions);return service}angular.module("app").factory("Contacts",Contacts),Contacts.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Devices($resource,governorUrl){var deviceUrl=governorUrl+"/device/:sendMessageAll",params={sendMessageAll:"@sendMessageAll"},actions={pushAll:{method:"GET",params:{sendMessageAll:"sendMessageAll"}},register:{method:"POST"},update:{method:"PUT"}},service=$resource(deviceUrl,params,actions);return service}angular.module("app").factory("Devices",Devices),Devices.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Likes($resource,governorUrl){var likesUrl=governorUrl+"/post/:like/:unlike",params={like:"@like",unlike:"@unlike"},actions={likePost:{method:"POST"},unlikePost:{method:"DELETE"}},service=$resource(likesUrl,params,actions);return service}angular.module("app").factory("Likes",Likes),Likes.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Messages($resource,governorUrl){var likesUrl=governorUrl+"/message/:sender/:list",params={sender:"@sender",list:"@list"},actions={getMyInboxSenderList:{method:"GET",params:{sender:"sender",list:"list"}},readMessagesFrom:{method:"GET"},sendMessage:{method:"POST"}},service=$resource(likesUrl,params,actions);return service}angular.module("app").factory("Messages",Messages),Messages.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Photos($resource,governorUrl,AuthService,$cordovaFileTransfer){var photosUrl=governorUrl+"/photos",params={},actions={removePhoto:{method:"DELETE"},getPhotos:{method:"GET",isArray:!0}},service=$resource(photosUrl,params,actions);return service.uploadPhoto=function(parameters,post){angular.extend(post,parameters);var filePath=post.file?post.file:"[]";delete post.file;var options={params:post,chunkedMode:!1,headers:{Connection:"close",Authorization:"Bearer "+AuthService.getToken()}};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/photo",filePath,options,!0)}},service}angular.module("app").factory("Photos",Photos),Photos.$inject=["$resource","governorUrl","AuthService","$cordovaFileTransfer"]}(),function(){"use strict";function Places($resource,governorUrl,$cordovaFileTransfer){var placeUrl=governorUrl+"/place/:findOne/:list/:mine/:within/:image/:photos/:getPlace",params={findOne:"@findOne",list:"@list",mine:"@mine",within:"@within",image:"@image",photos:"@photos",getPlace:"@getPlace"},actions={findOne:{method:"GET",params:{findOne:"findOne"}},getPlace:{method:"GET",params:{getPlace:"getPlace"}},getPlaces:{method:"GET",params:{list:"list"}},getMyPlaces:{method:"GET",params:{list:"list",mine:"mine"}},getPlacesWithin:{method:"GET",params:{list:"list",within:"within"}},getPlacePhotos:{method:"GET",params:{photos:"photos"},isArray:!0},findById:{method:"GET"},createPlace:{method:"POST"},createPlaceWithImage:{method:"POST",params:{image:"image"}},updatePlace:{method:"PUT",isArray:!0},updateMyPlace:{method:"PUT",params:{mine:"mine"},isArray:!0},updatePlaceWithImage:{method:"PUT",params:{image:"image"}},removePlace:{method:"DELETE"}},service=$resource(placeUrl,params,actions);return service.createPlaceWithImage=function(parameters,place){angular.extend(place,parameters);var filePath=place.file;delete place.file;var options={params:place,chunkedMode:!1};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/place/image",filePath,options)}},service.updatePlaceWithImage=function(parameters,place){angular.extend(place,parameters);var filePath=place.file;delete place.file;var options={params:place,chunkedMode:!1,httpMethod:"PUT"};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/place/image",filePath,options)}},service}angular.module("app").factory("Places",Places),Places.$inject=["$resource","governorUrl","$cordovaFileTransfer"]}(),function(){"use strict";function Posts($resource,governorUrl,$cordovaFileTransfer,AuthService){var postUrl=governorUrl+"/post/:find/:findOne/:list/:image/:mine/:like",params={find:"@find",findOne:"@findOne",list:"@list",image:"@image",mine:"@mine",like:"@like"},actions={find:{method:"GET",params:{find:"find"}},findOne:{method:"GET",params:{findOne:"findOne"}},getPosts:{method:"GET",params:{list:"list"}},getMyPosts:{method:"GET",params:{list:"list",mine:"mine"}},findById:{method:"GET"},createPost:{method:"POST"},updatePost:{method:"PUT"},likePost:{method:"POST",params:{like:"like"}},removePost:{method:"DELETE"}},service=$resource(postUrl,params,actions);return service.createPostWithImage=function(parameters,post){angular.extend(post,parameters);var filePath=post.file?post.file:"[]";delete post.file,post.category="SHOW-POST";var options={params:post,chunkedMode:!1,headers:{Connection:"close",Authorization:"Bearer "+AuthService.getToken()}};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/post",filePath,options,!0)}},service.updatePostWithImage=function(parameters,post){angular.extend(post,parameters);var filePath=post.file;delete post.file;var options={params:post,chunkedMode:!1,httpMethod:"PUT",headers:{Connection:"close",Authorization:"Bearer "+AuthService.getToken()}};return{$promise:$cordovaFileTransfer.upload(governorUrl+"/post",filePath,options,!0)}},service}angular.module("app").factory("Posts",Posts),Posts.$inject=["$resource","governorUrl","$cordovaFileTransfer","AuthService"]}(),function(){"use strict";function Products($resource,governorUrl){var productUrl=governorUrl+"/product/:list/:image/:mine/:checkProductCode/:ids/:comments/:within/:like/:unlike/:setSoldOut/:unsetSoldOut/:find/:getProductsWithin/:getProduct/:getProducts/:destroy",params={list:"@list",image:"@image",mine:"@mine",checkProductCode:"@checkProductCode",ids:"@ids",comments:"@comments",within:"@within",like:"@like",unlike:"@unlike",setSoldOut:"@setSoldOut",unsetSoldOut:"@unsetSoldOut",find:"@find",getProductsWithin:"@getProductsWithin",getProduct:"@getProduct",getProducts:"@getProducts",destroy:"@destroy"},actions={destroy:{method:"DELETE",params:{destroy:"destroy"}},getProductsWithin:{method:"GET",params:{getProductsWithin:"getProductsWithin"}},getProduct:{method:"GET",params:{getProduct:"getProduct"}},getProducts:{method:"GET",params:{getProducts:"getProducts"}},find:{method:"GET",params:{find:"find"}},setSoldOut:{method:"PUT",params:{setSoldOut:"setSoldOut"}},unsetSoldOut:{method:"PUT",params:{unsetSoldOut:"unsetSoldOut"}},unlike:{method:"PUT",params:{unlike:"unlike"}},like:{method:"PUT",params:{like:"like"}},getProductWithin:{method:"GET",params:{list:"list",within:"within"}},getProductsWithComments:{method:"GET",params:{comments:"comments"},isArray:!0},getProductsWithIds:{method:"GET",params:{ids:"ids"},isArray:!0},getMyProducts:{method:"GET",params:{list:"list",mine:"mine"}},checkProductCode:{method:"GET",params:{checkProductCode:"checkProductCode"}},findById:{method:"GET"},createProduct:{method:"POST"},updateProduct:{method:"PUT",isArray:!0},removeProduct:{method:"DELETE"},removeProducts:{method:"DELETE",isArray:!0}},service=$resource(productUrl,params,actions);return service}angular.module("app").factory("Products",Products),Products.$inject=["$resource","governorUrl"]}(),function(){"use strict";function RoyaltyPoints($resource,governorUrl){var royaltyUrl=governorUrl+"/royaltyPoint/:list/:mine",params={list:"@list",mine:"@mine"},actions={getRoyaltyPoints:{method:"GET",params:{list:"list"}},getMyRoyaltyPoints:{method:"GET",params:{list:"list",mine:"mine"}},findById:{method:"GET"},createRoyaltyPoint:{method:"POST"},updateRoyaltyPoint:{method:"PUT",isArray:!0},removeRoyaltyPoint:{method:"DELETE"}},service=$resource(royaltyUrl,params,actions);return service}angular.module("app").factory("RoyaltyPoints",RoyaltyPoints),RoyaltyPoints.$inject=["$resource","governorUrl"]}(),function(){"use strict";function Users($resource,governorUrl){var userUrl=governorUrl+"/:auth/:register/:user/:findOne/:update/:changePassword/:checkEmail/:local/:checkNickname/:list/:role/:myrole/:updateWithImage/:registerPlaceOwner",params={user:"@user",findOne:"@findOne",update:"@update",changePassword:"@changePassword",auth:"@auth",register:"@register",checkNickname:"@checkNickname",checkEmail:"@checkEmail",list:"@list",role:"@role",myrole:"@myrole",updateWithImage:"@updateWithImage",registerPlaceOwner:"@registerPlaceOwner"},actions={findOne:{method:"GET",params:{user:"user",findOne:"findOne"}},update:{method:"PUT",params:{user:"user",update:"update",role:void 0}},changePassword:{method:"PUT",params:{auth:"auth",local:"changePassword"}},checkEmail:{method:"GET",params:{user:"user",checkEmail:"checkEmail"}},getUsers:{method:"GET",params:{user:"user",list:"list"}},register:{method:"POST",params:{register:"register",role:void 0}},registerPlaceOwner:{method:"POST",params:{registerPlaceOwner:"registerPlaceOwner",role:void 0}},checkNickname:{method:"GET",params:{user:"user",checkNickname:"checkNickname"}},login:{method:"POST",params:{auth:"auth",local:"local"}},getMyRole:{method:"GET",params:{role:"role",myrole:"myrole"}},updateProfileWithImage:{method:"PUT",params:{user:"user",updateWithImage:"updateWithImage"}},updateUser:{method:"PUT",params:{user:"user",update:"update"},isArray:!0}},service=$resource(userUrl,params,actions);return service}angular.module("app").factory("Users",Users),Users.$inject=["$resource","governorUrl"]}(),function(){"use strict";function daum($window){return $window.daum}angular.module("app").factory("daum",daum),daum.$inject=["$window"]}(),function(){"use strict";function Firebase($window){return $window.Firebase}angular.module("app").factory("Firebase",Firebase),Firebase.$inject=["$window"]}(),function(){"use strict";function localStorage($window){return $window.localStorage}angular.module("app").factory("localStorage",localStorage),localStorage.$inject=["$window"]}(),function(){"use strict";function moment($window){return $window.moment}angular.module("app").factory("moment",moment),moment.$inject=["$window"]}(),function(){"use strict";function _($window){return $window._}angular.module("app").factory("_",_),_.$inject=["$window"]}(),function(){"use strict";function PushService($http,$log,$q,$cordovaDialogs,$window,$timeout,$rootScope,$cordovaMedia,googlePushSenderID,governorUrl,appStorage,Devices){function registerDevice(){var push=$window.PushNotification.init({android:{senderID:googlePushSenderID,icon:"pushicon"},ios:{badge:!0,sound:"true",alert:"true"}});ionic.Platform.isIOS()&&push.getApplicationIconBadgeNumber(function(n){push.setApplicationIconBadgeNumber(function(){},function(){},n)},function(){}),push.on("registration",function(result){ionic.Platform.isIOS()?storeDeviceToken(result.registrationId,"IOS"):ionic.Platform.isAndroid()&&storeDeviceToken(result.registrationId,"ANDROID")}),push.on("notification",function(notification){ionic.Platform.isAndroid()?$window.plugin.notification.local.schedule({title:notification.title,text:notification.message,icon:"res://icon.png",smallIcon:"res://pushicon.png"}):ionic.Platform.isIOS()&&handleIOS(notification)})}function storeDeviceToken(deviceId,deviceType){var registration={deviceId:deviceId,platform:deviceType,active:!0};return $http({url:governorUrl+"/device",method:"POST",headers:{"Content-Type":"application/json"},data:registration}).then(function(dataWrapper){return $log.info("PushService - registered to server: "+JSON.stringify(dataWrapper)),deviceId=dataWrapper.data.device.deviceId,appStorage.deviceId=deviceId,appStorage.user&&appStorage.user.id&&!appStorage.deviceUpdateDone?Devices.update({deviceId:appStorage.deviceId,user:appStorage.user.id}):!1}).then(function(devices){devices!==!1&&(appStorage.deviceUpdateDone=!0)})["catch"](function(err){$log.info("PushService - error: "+JSON.stringify(err))})}function handleIOS(notification){if(notification.additionalData.foreground===!0){if(notification.sound){var audio=$cordovaMedia.newMedia(notification.sound);audio.then(function(r){$timeout(function(){audio.play()},500)},function(r){})}$cordovaDialogs.alert(notification.title,notification.message)}else $cordovaDialogs.alert(notification.title,notification.message)}var deviceId=null;this.registerDevice=registerDevice,this.getDeviceId=function(){return deviceId}}angular.module("applicat.push.service",["ngCordova"]).service("PushService",PushService),PushService.$inject=["$http","$log","$q","$cordovaDialogs","$window","$timeout","$rootScope","$cordovaMedia","googlePushSenderID","governorUrl","appStorage","Devices"]}(),function(){"use strict";function AppService(Products,ProductListModel,U,Message,appStorage){function preloadState(state,params){Message.loading();var query,onData;return"main.productList.market"===state?(query={where:{category:"market"},limit:10,sort:"id DESC",populates:["photos","place"]},onData=function(productsWrapper){return ProductListModel.market.products=productsWrapper.products,ProductListModel.market.more=productsWrapper.more,U.preload(ProductListModel.market.products,"cloudinary200",!0)}):"main.productList.pawnShop"===state&&(query={where:{category:"pawnShop"},limit:10,sort:"id DESC",populates:["photos","place"]},onData=function(productsWrapper){return ProductListModel.pawnShop.products=productsWrapper.products,ProductListModel.pawnShop.more=productsWrapper.more,U.preload(ProductListModel.pawnShop.products,"cloudinary200",!0)}),Products.find(query).$promise.then(onData)}function productListFind(category,model){return Message.loading(),Products.find({where:{category:category},limit:10}).$promise.then(function(productsWrapper){return model.products=productsWrapper.products,model.more=productsWrapper.more,U.preload(model.products,"cloudinary200",!0)})}function getMyPawnShopProducts(){return Message.loading(),Products.find({where:{id:appStorage.user.id,category:"market"},limit:10,populates:["photos","place"]}).$promise.then(function(productsWrapper){return MyProductListModel.products=productsWrapper.products,MyProductListModel.more=productsWrapper.more,U.preload(MyProductListModel.products,"cloudinary200",!0)})}function getMarketProducts(){return Message.loading(),Products.find({where:{category:"market"},limit:10,sort:"id DESC",populates:["photos","place"]}).$promise.then(function(productsWrapper){return ProductListModel.market.products=productsWrapper.products,ProductListModel.market.more=productsWrapper.more,U.preload(ProductListModel.products,"cloudinary200",!0)})}function getPawnShopProducts(){return Message.loading(),Products.find({where:{category:"pawnShop"},limit:10,sort:"id DESC",populates:["photos","place"]}).$promise.then(function(productsWrapper){return ProductListModel.pawnShop.products=productsWrapper.products,ProductListModel.pawnShop.more=productsWrapper.more,U.preload(ProductListModel.products,"cloudinary200",!0)})}var service={getMyPawnShopProducts:getMyPawnShopProducts,getMarketProducts:getMarketProducts,getPawnShopProducts:getPawnShopProducts,productListFind:productListFind,preloadState:preloadState};return service}angular.module("app").factory("AppService",AppService),AppService.$inject=["Products","ProductListModel","U","Message","appStorage"]}(),function(){"use strict";function appStorage($localStorage,appName){function setInitialState(){$localStorage[appName]||($localStorage[appName]={});var storage=$localStorage[appName];void 0===storage.firstTime&&(storage.firstTime=!0)}return setInitialState(),$localStorage[appName]}angular.module("app").factory("appStorage",appStorage),appStorage.$inject=["$localStorage","appName"]}(),function(){"use strict";function AuthInterceptor($q,$injector,$location,LocalService,appName,appStorage){return{request:function(req){var token=appStorage.token;return token&&(req.headers.Authorization="Bearer "+token),req}}}function AuthService($http,$q,$location,$state,governorUrl,LocalService,appName,kakaoKey,facebookKey,$cordovaOauth){this.registerWithImage=function(user,file,success,fail){var options=new FileUploadOptions,newUser=angular.copy(user);options.params=newUser,options.headers={Connection:"close"},options.chunkedMode=!1;var ft=new FileTransfer;ft.upload(file,encodeURI(governorUrl+"/user/registerWithImage"),success,fail,options,!0)},this.verifyResetCode=function(email,code){var deferred=$q.defer();return $http({url:governorUrl+"/user/passwordresetcomplete",method:"put",headers:{"Content-Type":"application/json"},data:{email:email,code:code}}).success(function(data,status,headers,config){LocalService.set(appName+"_auth_token",JSON.stringify(data)),deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.passReset=function(email){var deferred=$q.defer();return $http({url:governorUrl+"/user/resetStart",method:"post",headers:{"Content-Type":"application/json"},data:{email:email}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.changePassword=function(oldPassword,newPassword){var deferred=$q.defer();return $http({url:governorUrl+"/user/changePassword",method:"post",headers:{"Content-Type":"application/json"},data:{oldPassword:oldPassword,newPassword:newPassword}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.checkNickname=function(nickname){var deferred=$q.defer();return $http({url:governorUrl+"/user/checknickname",method:"get",headers:{"Content-Type":"application/json"},params:{nickname:nickname}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.checkEmail=function(email){var deferred=$q.defer();return $http({url:governorUrl+"/user/checkEmail",method:"get",headers:{"Content-Type":"application/json"},params:{email:email}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.getMyProfile=function(){var deferred=$q.defer();return $http({url:governorUrl+"/user/profile",method:"get",headers:{"Content-Type":"application/json"}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.updateMyProfile=function(nickname){var deferred=$q.defer();return $http({url:governorUrl+"/user/update",method:"put",headers:{"Content-Type":"application/json"},data:{nickname:nickname}}).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){deferred.reject(data)}),deferred.promise},this.updateMyProfileWithImage=function(user,file,success,fail){var options=new FileUploadOptions,updateUser=angular.copy(user);options.params=updateUser,options.httpMethod="PUT",options.headers={Connection:"close",Authorization:"Bearer "+this.getToken()},options.chunkedMode=!1;var ft=new FileTransfer;ft.upload(file,encodeURI(governorUrl+"/user/updateWithImage"),success,fail,options,!0);
},this.loginWithKakao=function(){var deferred=$q.defer();return $cordovaOauth.kakao(kakaoKey).then(function(result){result.provider="kakao",$http({url:governorUrl+"/auth/register",method:"post",headers:{"Content-Type":"application/json"},data:result}).success(function(data,status,headers,config){LocalService.set(appName+"_auth_token",JSON.stringify(data)),setUser(data.user),deferred.resolve({message:"done"})}).error(function(data,status,headers,config){deferred.reject(data)})},function(error){deferred.reject(error)}),deferred.promise},this.loginWithFacebook=function(){var deferred=$q.defer();return $cordovaOauth.facebook(facebookKey,["email"]).then(function(result){result.provider="facebook",$http({url:governorUrl+"/auth/register",method:"post",headers:{"Content-Type":"application/json"},data:result}).success(function(data,status,headers,config){LocalService.set(appName+"_auth_token",JSON.stringify(data)),setUser(data.user),deferred.resolve({message:"done"})}).error(function(data,status,headers,config){deferred.reject(data)})},function(error){deferred.reject(error)}),deferred.promise}}angular.module("app").factory("AuthInterceptor",AuthInterceptor),AuthInterceptor.$inject=["$q","$injector","$location","LocalService","appName","appStorage"],angular.module("app").service("AuthService",AuthService),AuthService.$inject=["$http","$q","$location","$state","governorUrl","LocalService","appName","kakaoKey","facebookKey","$cordovaOauth"]}(),function(){"use strict";function Distance($window){var service={between:$window.geolib.getDistance};return service}angular.module("app").factory("Distance",Distance),Distance.$inject=["$window"]}(),function(){"use strict";function Dom($timeout,$window){function focusById(id){$timeout(function(){var domElement=$window.document.getElementById(id);domElement&&domElement.focus()},0)}function blurById(id){$timeout(function(){var domElement=$window.document.getElementById(id);domElement&&domElement.blur()},0)}var service={focusById:focusById,blurById:blurById};return service}angular.module("app").factory("Dom",Dom),Dom.$inject=["$timeout","$window"]}(),function(){"use strict";function FavoriteService(appStorage,Products,Posts){function likePost(postId){return Posts.like({id:postId}).$promise}function unlikePost(postId){return Posts.unlike({id:postId}).$promise}function likeProduct(id){return Products.like({id:id}).$promise}function unlikeProduct(id){return Products.unlike({id:id}).$promise}function toggleProduct(id){var promise;return isFavorite(id)?promise=unlikeProduct(id):isFavorite(id)||(promise=likeProduct(id)),promise.then(function(product){return toggleSaveToFavorite(id),product})["catch"](function(err){})}function togglePost(postId){var promise;return isFavorite(postId)?promise=unlikePost(postId):isFavorite(postId)||(promise=likePost(postId)),promise.then(function(post){return toggleSaveToFavorite(postId),post})["catch"](function(err){})}function toggleSaveToFavorite(id){if(Array.isArray(appStorage.favorites)||(appStorage.favorites=[]),isFavorite(id)){var index=appStorage.favorites.indexOf(id);appStorage.favorites.splice(index,1)}else isFavorite(id)||appStorage.favorites.push(id);return appStorage.favorites}function isFavorite(id){Array.isArray(appStorage.favorites)||(appStorage.favorites=[]);for(var i=0;i<appStorage.favorites.length;i++)if(String(id)===String(appStorage.favorites[i]))return!0;return!1}var service={likeProduct:likeProduct,unlikeProduct:unlikeProduct,likePost:likePost,unlikePost:unlikePost,toggleProduct:toggleProduct,togglePost:togglePost,toggleSaveToFavorite:toggleSaveToFavorite,isFavorite:isFavorite};return service}angular.module("app").factory("FavoriteService",FavoriteService),FavoriteService.$inject=["appStorage","Products","Posts"]}(),function(){"use strict";function ImagePreload($q){function preload(urls){function onImageLoad(deferred){return function(){deferred.resolve()}}function onImageError(deferred,url){return function(){deferred.reject(url)}}var promises=[],images=[];return angular.forEach(urls,function(url){var deferred=$q.defer(),img=new Image;img.onload=onImageLoad(deferred),img.onerror=onImageError(deferred,url),promises.push(deferred.promise),img.src=url,images.push(img)}),$q.all(promises)}var service={preload:preload};return service}angular.module("app").factory("ImagePreload",ImagePreload),ImagePreload.$inject=["$q"]}(),function(){"use strict";function ImageService(governorUrl,$cordovaCamera,$cordovaFile,Message,$window,$timeout,Upload){function get(params,index){function setOptions(){var sourceType;"gallery"===params.from?sourceType=0:"camera"===params.from&&(sourceType=1);var options={allowEdit:!0,quality:40,destinationType:Camera.DestinationType.FILE_URI,encodingType:Camera.EncodingType.JPEG,targetWidth:800,correctOrientation:!0,mediaType:Camera.MediaType.PICTURE,cameraDirection:Camera.Direction.BACK,sourceType:sourceType};return options}return $window.cordova?$cordovaCamera.getPicture(setOptions()).then(function(filePath){index>=0?(params.fileUris.splice(index,1,null),params.fileUris.splice(index,1,filePath)):params.fileUris.push(filePath);var name=filePath.substr(filePath.lastIndexOf("/")+1),namePath=filePath.substr(0,filePath.lastIndexOf("/")+1);return $cordovaFile.readAsDataURL(namePath,name)}).then(function(dataUri){$timeout(function(){index>=0?(params.dataUris.splice(index,1,null),params.dataUris.splice(index,1,dataUri)):params.dataUris.push(dataUri)},0)})["catch"](function(err){Message.alert("이미지 알림","이미지 불러오기 실패하였습니다. 갤러리에서 선택해주세요.")}):!1}function post(params,method){var dataUris=params.dataUris,fields=params.fields,url=params.url;"/"!==url[0]&&(url="/"+url),dataUris=wrapInArray(dataUris);var filesToSend=[];angular.forEach(dataUris,function(base64Data){null!=base64Data&&filesToSend.push(base64ToFile(base64Data))});var promise=Upload.upload({url:governorUrl+url,method:method||"POST",file:filesToSend,fields:fields,header:{enctype:"multipart/form-data"}});return promise}function clean(){return $cordovaCamera.cleanup()}function wrapInArray(obj){var array=[];return Array.isArray(obj)?Array.isArray(obj)&&(array=obj):array=[obj],array}function base64ToFile(dataUris){var byteString,mimestring;byteString=-1!==dataUris.split(",")[0].indexOf("base64")?$window.atob(dataUris.split(",")[1]):decodeURI(dataUris.split(",")[1]),mimestring=dataUris.split(",")[0].split(":")[1].split(";")[0];for(var content=[],i=0;i<byteString.length;i++)content[i]=byteString.charCodeAt(i);return new $window.Blob([new $window.Uint8Array(content)],{type:mimestring})}var service={get:get,post:post,clean:clean};return service}angular.module("app").factory("ImageService",ImageService),ImageService.$inject=["governorUrl","$cordovaCamera","$cordovaFile","Message","$window","$timeout","Upload"]}(),function(){"use strict";function LinkService($window,$cordovaSocialSharing,appStorage,Message,$state){function call(number){return appStorage.token?void($window.location.href="tel:"+number):Message.alert("전화걸기 알림","로그인을 해주세요.").then(function(){$state.go("main.login")})}function open(link){return $window.open(link,"_system")}function share(title,content,url){return $cordovaSocialSharing.share(title,content,null,url).then(function(suc){},function(err){})}var service={call:call,open:open,share:share};return service}angular.module("app").factory("LinkService",LinkService),LinkService.$inject=["$window","$cordovaSocialSharing","appStorage","Message","$state"]}(),function(){"use strict";angular.module("app").factory("LocalService",function(){return{get:function(key){return localStorage.getItem(key)},set:function(key,val){return localStorage.setItem(key,val)},unset:function(key){return localStorage.removeItem(key)},getSession:function(key){return sessionStorage.getItem(key)},setSession:function(key,val){return sessionStorage.setItem(key,val)},unsetSession:function(key){return sessionStorage.removeItem(key)}}})}(),function(){"use strict";function Message($ionicLoading,$ionicPopup){function loadingDefault(message){$ionicLoading.show(message)}function messageSuccess(message){$ionicLoading.show({template:'<h4 class="message-success">'+message+"</h4>",duration:2e3})}function messageError(message){$ionicLoading.show({template:'<h4 class="message-error">'+message+"</h4>",duration:2e3})}function loadingHide(){$ionicLoading.hide()}function popUpAlertDefault(title,message){return $ionicPopup.alert({title:title||"인터넷이 끊겼습니다.",template:message||"인터넷을 켜주세요."})}var service={loading:loadingDefault,hide:loadingHide,success:messageSuccess,error:messageError,alert:popUpAlertDefault};return service}angular.module("app").factory("Message",Message),Message.$inject=["$ionicLoading","$ionicPopup"]}(),function(){"use strict";function Preload(Products,Places,Bids,BidListPawnShopPendingModel,ProductUpdateModel,BidDetailPawnShopPendingModel,BidListPawnShopRespondedModel,ProductListModel,ProductDetailModel,PlaceDetailModel,BidDetailUserModel,BidDetailPawnShopRespondedModel,FavoriteProductListModel,FavoriteProductDetailModel,MyProductListUserModel,BidListUserModel,MyProductListPawnShopModel,U,$q,$filter,_,Message,appStorage,$timeout,$state){function photos(arrayOfObjsWithPhotosArray,cloudinaryFilterName,onlyFirstOnesBool){var urls=getPhotos(arrayOfObjsWithPhotosArray,cloudinaryFilterName,onlyFirstOnesBool),promises=[];return angular.forEach(urls,function(url){var deferred=$q.defer(),img=new Image;img.onload=onImageLoad(deferred),img.onerror=onImageError(deferred,url),promises.push(deferred.promise),img.src=url}),$q.all(promises)}function stateWithBids(state,params,moveToStateBool,navDirection){Message.loading();var promise;return"main.bidListUser"===state?(promise=Bids.find({product:params.product,limit:10,status:"responded",sort:"updatedAt DESC",populates:["photos","owner","place","createdBy"]}).$promise.then(function(bidsWrapper){return BidListUserModel.bids=bidsWrapper.bids,BidListUserModel.more=bidsWrapper.more,photos(BidListUserModel.bids,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):"main.bidDetailUser"===state?(promise=Bids.findOne({id:params.id,populates:["photos","createdBy","owner"]}).$promise.then(function(bid){return BidDetailUserModel.bid=bid,photos(BidDetailUserModel.bid,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):"main.bidListPawnShopPending"===state?(promise=Bids.find({owner:appStorage.place.owner,limit:10,status:"pending",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){return $timeout(function(){BidListPawnShopPendingModel.bids=bidsWrapper.bids,BidListPawnShopPendingModel.more=bidsWrapper.more},0),photos(BidListPawnShopPendingModel.bids,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):"main.bidDetailPawnShopPending"===state?(promise=Bids.findOne({id:params.id,populates:["photos","createdBy"]}).$promise.then(function(bid){return BidDetailPawnShopPendingModel.bid=bid,photos(BidDetailPawnShopPendingModel.bid,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):"main.bidListPawnShopResponded"===state?(promise=Bids.find({owner:appStorage.place.owner,limit:10,status:"responded",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){return BidListPawnShopRespondedModel.bids=bidsWrapper.bids,BidListPawnShopRespondedModel.more=bidsWrapper.more,photos(BidListPawnShopRespondedModel.bids,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):"main.bidDetailPawnShopResponded"===state?(promise=Bids.findOne({id:params.id,populates:["photos","createdBy"]}).$promise.then(function(bid){return BidDetailPawnShopRespondedModel.bid=bid,photos(BidDetailPawnShopRespondedModel.bid,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):void 0}function stateWithPlaces(state,params,moveToStateBool,navDirection){Message.loading();var promise;return"main.placeDetail"===state?(promise=Places.getPlace({id:params.id,populates:["photos"]}).$promise.then(function(place){return PlaceDetailModel.place=place,photos(PlaceDetailModel.place,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):void 0}function stateWithProducts(state,params,moveToStateBool,navDirection){Message.loading();var query,onData,promise;if("main.productList.market"===state)return query={category:params.category,longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1],distance:appStorage.marketDistance,status:"selling",limit:10,populates:["photos","place"]},"전체보기"===appStorage.address&&(query.sort={_id:-1},query.distance=999999),onData=function(productsWrapper){return ProductListModel.market.products=productsWrapper.products,ProductListModel.market.more=productsWrapper.more,photos(ProductListModel.market.products,"cloudinary200",!0)},promise=Products.getProductsWithin(query).$promise.then(onData),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.productList.pawnShop"===state)return query={category:params.category,showBid:!0,limit:10,sort:"id DESC",populates:["photos"]},onData=function(productsWrapper){return ProductListModel.pawnShop.products=productsWrapper.products,ProductListModel.pawnShop.more=productsWrapper.more,photos(ProductListModel.pawnShop.products,"cloudinary200",!0)},promise=Products.getProducts(query).$promise.then(onData),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.placeId"===state)return query={place:params.id,category:params.category,limit:10,sort:"id DESC",populates:["photos"]},onData=function(productsWrapper){return ProductListModel.placeId.products=productsWrapper.products,ProductListModel.placeId.more=productsWrapper.more,photos(ProductListModel.placeId.products,"cloudinary200",!0)},promise=Products.getProducts(query).$promise.then(onData),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.productDetail.market"===state)return appStorage.user.lookAround?(Message.hide(),Message.alert("둘러보기 알림.","로그인을 하셔야 보실수있는 내용입니다.").then(function(){$state.go("main.login")})):(query={id:params.id,populates:["photos","place"]},onData=function(product){return ProductDetailModel.market.product=product,photos(ProductDetailModel.market.product,"cloudinary600",!1)},promise=Products.getProduct(query).$promise.then(onData),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise);if("main.productDetail.pawnShop"===state)return appStorage.user.lookAround?(Message.hide(),Message.alert("둘러보기 알림.","로그인을 하셔야 보실수있는 내용입니다.").then(function(){$state.go("main.login")})):(promise=Products.getProduct({id:params.id,populates:["photos","place","createdBy"]}).$promise.then(function(product){return ProductDetailModel.pawnShop.product=product,photos(ProductDetailModel.pawnShop.product,"cloudinary600",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise);if("main.myProductListUser"===state)return promise=Products.getProducts({createdBy:appStorage.user.id,category:"pawnShop",limit:10,sort:"id DESC",populates:["photos"]}).$promise.then(function(productsWrapper){return $timeout(function(){MyProductListUserModel.products=productsWrapper.products,MyProductListUserModel.more=productsWrapper.more},0),photos(MyProductListUserModel.products,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.myProductListPawnShop"===state)return promise=Products.getProducts({createdBy:appStorage.user.id,category:"market",limit:10,sort:"id DESC",populates:["photos"]}).$promise.then(function(productsWrapper){return MyProductListPawnShopModel.products=productsWrapper.products,MyProductListPawnShopModel.more=productsWrapper.more,photos(MyProductListPawnShopModel.products,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.productUpdate.info"===state)return promise=Products.getProduct({id:params.id,populates:["photos"]}).$promise.then(function(product){return product.price=Number(product.price),ProductUpdateModel.product=product,photos(ProductUpdateModel.product,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise;if("main.favoriteProductList"===state){var favoriteIds=appStorage.favorites;return favoriteIds&&0!==favoriteIds.length||(favoriteIds="none"),promise=Products.getProducts({id:favoriteIds,limit:10,sort:"id DESC",populates:["photos","place"]}).$promise.then(function(productsWrapper){return FavoriteProductListModel.products=productsWrapper.products,FavoriteProductListModel.more=productsWrapper.more,photos(FavoriteProductListModel.products,"cloudinary200",!0)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise}return"main.favoriteProductDetail"===state?(promise=Products.getProduct({id:params.id,populates:["photos","place","createdBy"]}).$promise.then(function(product){return FavoriteProductDetailModel.product=product,photos(FavoriteProductDetailModel.product,"cloudinary400",!1)}),moveToStateBool&&promise.then(function(){U.goToState(state,params,navDirection)}),promise):void 0}function onImageLoad(deferred){return function(){deferred.resolve()}}function onImageError(deferred,url){return function(){deferred.reject(url)}}function getPhotos(posts,cloudinaryFilterName,onlyFirstOnesBool){var preProcessedUrls=[];Array.isArray(posts)||(posts=[posts]);var arrayOfUrls=_.pluck(posts,"photos");angular.forEach(arrayOfUrls,function(photos){var urls=_.pluck(photos,"url");if(onlyFirstOnesBool){var first=urls[0];urls=[first]}preProcessedUrls=preProcessedUrls.concat(urls)});var urls=_.map(preProcessedUrls,function(url){return $filter(cloudinaryFilterName)(url)});return urls=_.filter(urls,function(url){return null!=url})}var service={photos:photos,stateWithProducts:stateWithProducts,stateWithPlaces:stateWithPlaces,stateWithBids:stateWithBids};return service}angular.module("app").factory("Preload",Preload),Preload.$inject=["Products","Places","Bids","BidListPawnShopPendingModel","ProductUpdateModel","BidDetailPawnShopPendingModel","BidListPawnShopRespondedModel","ProductListModel","ProductDetailModel","PlaceDetailModel","BidDetailUserModel","BidDetailPawnShopRespondedModel","FavoriteProductListModel","FavoriteProductDetailModel","MyProductListUserModel","BidListUserModel","MyProductListPawnShopModel","U","$q","$filter","_","Message","appStorage","$timeout","$state"]}(),function(){"use strict";function rootScopeService($state,$stateParams,$ionicHistory,$ionicSideMenuDelegate,Message,$timeout,appStorage,$rootScope,_,$ionicModal,$ionicViewSwitcher,devMode){function isState(state){return state===$ionicHistory.currentStateName()}function areStates(states){return-1!==states.indexOf($ionicHistory.currentStateName())}function getState(){return $ionicHistory.currentStateName()}function isParam(paramObj){for(var key in paramObj)if($state.params[key]!==paramObj[key])return!1;return!0}function hasParam(paramKey){return""!==$state.params[paramKey]?!0:!1}function getParam(key){return $state.params[key]}function goToState(state,params,direction,showSpinner){showSpinner&&loading(),direction&&$ionicViewSwitcher.nextDirection(direction),$ionicSideMenuDelegate.toggleLeft(!1),$state.go(state,params)}function goBack(direction){direction&&$ionicViewSwitcher.nextDirection(direction),$ionicHistory.goBack()}function loading(){Message.loading(),$timeout(function(){Message.hide()},5e3)}function closeSideMenu(){$ionicSideMenuDelegate.toggleLeft(!1)}function toggleSideMenu(requireLoggedIn){return requireLoggedIn&&!appStorage.token?Message.alert("둘러보기 알림","로그인을 하셔야 볼수있는 내용입니다.").then(function(){$state.go("main.login")}):void $ionicSideMenuDelegate.toggleLeft()}function comingSoon(title){return Message.alert(title+" 준비중인 서비스입니다.","빠른시일내에 준비완료하겠습니다.")}var service={appStorage:appStorage,$state:$state,$stateParams:$stateParams,isState:isState,areStates:areStates,getState:getState,isParam:isParam,hasParam:hasParam,getParam:getParam,goToState:goToState,goBack:goBack,loading:loading,toggleSideMenu:toggleSideMenu,closeSideMenu:closeSideMenu,comingSoon:comingSoon,devMode:devMode};return $ionicModal.fromTemplateUrl("state/modal/requestLogin.html",{scope:$rootScope,animation:"mh-slide"}).then(function(modal){$rootScope.requestLoginModal=modal}),service}angular.module("app").factory("rootScopeService",rootScopeService),rootScopeService.$inject=["$state","$stateParams","$ionicHistory","$ionicSideMenuDelegate","Message","$timeout","appStorage","$rootScope","_","$ionicModal","$ionicViewSwitcher","devMode"]}(),function(){"use strict";function U($ionicHistory,$ionicScrollDelegate,$timeout,_,$filter,ImagePreload,Message,$ionicSideMenuDelegate,$state,$ionicViewSwitcher,$ionicSlideBoxDelegate){function isForwardView(stateName){var isView=$ionicHistory.viewHistory().forwardView&&$ionicHistory.viewHistory().forwardView.stateName===stateName;return isView}function isBackView(stateName){var isView=$ionicHistory.viewHistory().backView&&$ionicHistory.viewHistory().backView.stateName===stateName;return isView}function isSiblingView(stateName){return isForwardView(stateName)||isBackView(stateName)}function areSiblingViews(stateNames){var i,stateName;for(i=0;i<stateNames.length;i++)if(stateName=stateNames[i],isSiblingView(stateName))return!0;return!1}function resize(){$timeout(function(){$ionicScrollDelegate.resize()},0)}function update(){$timeout(function(){$ionicSlideBoxDelegate.update()},0)}function resetSlides(){$ionicSlideBoxDelegate.slide(0,0),$ionicSlideBoxDelegate.update()}function reset(model){for(var key in model)Array.isArray(model[key])?model[key]=[]:null!==model[key]&&"object"==typeof model[key]?model[key]={}:"boolean"==typeof model[key]?model[key]=!1:model[key]=null}function goToState(state,params,direction){Message.hide(),$timeout(function(){direction&&$ionicViewSwitcher.nextDirection(direction),$state.go(state,params),$ionicSideMenuDelegate.toggleLeft(!1)},0)}function goBack(direction){direction&&$ionicViewSwitcher.nextDirection(direction),$ionicHistory.goBack()}function error(err){Message.hide(),Message.alert()}function bindData(data,model,name){"s"===name[name.length-1]?(model[name]=data[name],model.more=data.more):model[name]=data,resize(),$timeout(function(){model.loading=!1},50)}function appendData(dataWrapper,model,name){"s"===name[name.length-1]&&(angular.forEach(dataWrapper[name],function(item){model[name].push(item)}),model.more=dataWrapper.more,resize())}function broadcast($scope){$scope.$broadcast("scroll.refreshComplete"),$scope.$broadcast("scroll.infiniteScrollComplete")}var service={isForwardView:isForwardView,isBackView:isBackView,isSiblingView:isSiblingView,areSiblingViews:areSiblingViews,resize:resize,update:update,resetSlides:resetSlides,reset:reset,goToState:goToState,goBack:goBack,error:error,bindData:bindData,appendData:appendData,broadcast:broadcast};return service}angular.module("app").factory("U",U),U.$inject=["$ionicHistory","$ionicScrollDelegate","$timeout","_","$filter","ImagePreload","Message","$ionicSideMenuDelegate","$state","$ionicViewSwitcher","$ionicSlideBoxDelegate"]}(),function(angular){"use strict";function top(){function compile(element,attrs){var height=attrs.top;return ionic.Platform.isIOS()?element.css("top",Number(height)+20+"px"):element.css("top",Number(height)+"px"),function(){}}return{restrict:"A",compile:compile}}angular.module("app").directive("top",top),top.$inject=[]}(angular),function(){"use strict";function parentScroll($ionicScrollDelegate,$timeout,$window,$document){function compile(element,attr){return $window.horizontalIonScrollCount||($window.horizontalIonScrollCount=0),$window.horizontalIonScrollCount++,attr.delegateHandle="horizontal"+$window.horizontalIonScrollCount,function(scope,element,attr){$timeout(function(){var horizontal=attr.delegateHandle,sv=$ionicScrollDelegate.$getByHandle(horizontal).getScrollView(),container=sv.__container,originaltouchStart=sv.touchStart,originalmouseDown=sv.mouseDown,originaltouchMove=sv.touchMove,originalmouseMove=sv.mouseMove;container.removeEventListener("touchstart",sv.touchStart),container.removeEventListener("mousedown",sv.mouseDown),$document.removeEventListener("touchmove",sv.touchMove),$document.removeEventListener("mousemove",sv.mousemove),sv.touchStart=function(e){e.preventDefault=function(){},originaltouchStart.apply(sv,[e])},sv.touchMove=function(e){e.preventDefault=function(){},originaltouchMove.apply(sv,[e])},sv.mouseDown=function(e){e.preventDefault=function(){},originalmouseDown&&originalmouseDown.apply(sv,[e])},sv.mouseMove=function(e){e.preventDefault=function(){},originalmouseMove&&originalmouseMove.apply(sv,[e])},container.addEventListener("touchstart",sv.touchStart,!1),container.addEventListener("mousedown",sv.mouseDown,!1),$document.addEventListener("touchmove",sv.touchMove,!1),$document.addEventListener("mousemove",sv.mouseMove,!1)})}}return{scope:!0,restrict:"A",compile:compile}}angular.module("app").directive("parentScroll",parentScroll),parentScroll.$inject=["$ionicScrollDelegate","$timeout","$window","$document"]}(),function(){"use strict";function loading(){return{replace:!0,template:'<div class="w100p h100vh flex light-grey-bg absolute"style="z-index: 2"><ion-spinner class="spinner-40px mb88px" icon="ripple"></ion-spinner></div>'}}angular.module("app").directive("loading",loading),loading.$inject=[]}(),function(){"use strict";angular.module("app").directive("ngEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter)}),event.preventDefault())})}})}(),function(){"use strict";function onFinishRender($timeout){function link(scope){scope.$last===!0&&$timeout(function(){scope.$emit("ngRepeatFinished")})}return{restrict:"A",link:link}}angular.module("app").directive("onFinishRender",onFinishRender),onFinishRender.$inject=["$timeout"]}(),function(){"use strict";function touch($timeout){function link(scope,element){element.on("click",function(){element.addClass("touch"),$timeout(function(){element.removeClass("touch")},50)})}return{restrict:"A",link:link}}angular.module("app").directive("touch",touch),touch.$inject=["$timeout"]}(),function(){"use strict";function vw($rootScope,$window){function link(scope,element){$rootScope.vw=element.prop("offsetWidth"),$window.addEventListener("resize",function(){$rootScope.$apply(function(){$rootScope.vw=element.prop("offsetWidth")})})}return{link:link}}angular.module("app").directive("vw",vw),vw.$inject=["$rootScope","$window"]}(),function(){"use strict";function appText(){return function(input){return"faq"===input?"자주 묻는 질문":"notification"===input?"공지사항":"high"===input?"상":"medium"===input?"중":"low"===input?"하":"selling"===input?"판매중":"sold"===input?"판매완료":void 0}}angular.module("app").filter("appText",appText),appText.$inject=[]}(),function(){"use strict";function cloudinaryFilter(size){var matching=/upload/;return function(input){if(input){var index=input.search(matching);return-1!==index?input.substring(0,index)+"upload/c_scale,w_"+size+"/"+input.substring(input.lastIndexOf("/")):input}return null==input?null:input}}angular.module("app").filter("cloudinary800",cloudinaryFilter.bind(null,800)).filter("cloudinary750",cloudinaryFilter.bind(null,750)).filter("cloudinary700",cloudinaryFilter.bind(null,700)).filter("cloudinary650",cloudinaryFilter.bind(null,650)).filter("cloudinary600",cloudinaryFilter.bind(null,600)).filter("cloudinary550",cloudinaryFilter.bind(null,550)).filter("cloudinary500",cloudinaryFilter.bind(null,500)).filter("cloudinary450",cloudinaryFilter.bind(null,450)).filter("cloudinary400",cloudinaryFilter.bind(null,400)).filter("cloudinary350",cloudinaryFilter.bind(null,350)).filter("cloudinary300",cloudinaryFilter.bind(null,300)).filter("cloudinary250",cloudinaryFilter.bind(null,250)).filter("cloudinary200",cloudinaryFilter.bind(null,200)).filter("cloudinary150",cloudinaryFilter.bind(null,150)).filter("cloudinary100",cloudinaryFilter.bind(null,100)).filter("cloudinary50",cloudinaryFilter.bind(null,50))}(),function(){"use strict";function mToKm(){return function(input){return input>=1e3?(input/1e3).toFixed(2)+" km":void 0===input?"0 m":input+" m"}}angular.module("app").filter("mToKm",mToKm)}(),function(){"use strict";function groupByOpeningHours(_){function filter(openingHours){if(!openingHours)return["업데이트 해주세요"];openingHours=appendIndexToObj(openingHours);var grouped=groupByBusinessHours(openingHours),orderedResultArray=createArrayOfObjWithGroup(grouped),textArray=_.map(orderedResultArray,function(result){result.days=_.map(result.days,function(day){var daysKorean=parseDay(day);return daysKorean}),result.days=tildeArrayValuesToText(result.days);var apendTime="";apendTime=result.start===result.end?"휴무":result.start+" ~ "+result.end;var texts=result.days+" "+apendTime;return texts});return textArray}function appendIndexToObj(openingHours){for(var i=0;i<openingHours.length;i++)openingHours[i].index=i;return openingHours}function groupByBusinessHours(openingHours){var grouped=_.groupBy(openingHours,function(hoursObj){var start=hoursObj.start,end=hoursObj.end,groupCategory=start+end;return groupCategory});return grouped}function createArrayOfObjWithGroup(grouped){for(var keys=Object.keys(grouped),resultArray=[],i=0;i<keys.length;i++){for(var key=keys[i],subOpeningHoursArray=grouped[key],daysResult=[],j=0;j<subOpeningHoursArray.length;j++){var openingHourObj=subOpeningHoursArray[j];daysResult.push(openingHourObj.index)}var start=subOpeningHoursArray[0].start,end=subOpeningHoursArray[0].end;resultArray.push({days:daysResult,start:start,end:end})}var orderedResultArray=_.sortBy(resultArray,function(obj){var day=obj.days[0];return 0===day&&(day=7),day});return orderedResultArray}function parseDay(day){return 0===day?"일":1===day?"월":2===day?"화":3===day?"수":4===day?"목":5===day?"금":6===day?"토":void 0}function tildeArrayValuesToText(array){for(var daysInNumbers=_.map(array,function(dayInKorean){return"일요일"===dayInKorean?7:"월"===dayInKorean?1:"화"===dayInKorean?2:"수"===dayInKorean?3:"목"===dayInKorean?4:"금"===dayInKorean?5:"토"===dayInKorean?6:void 0}),i=0;i<daysInNumbers.length-1;i++){var day_1=daysInNumbers[i],day_2=daysInNumbers[i+1];if(Math.abs(day_1-day_2)>1){for(var concatStart=array[0],j=1;j<daysInNumbers.length;j++)concatStart=concatStart+", "+array[j];return concatStart}}return array.length>2?array[0]+" ~ "+array[array.length-1]:2===array.length?array[0]+", "+array[1]:1===array.length?array[0]:void 0}return filter}angular.module("app").filter("groupByOpeningHours",groupByOpeningHours),groupByOpeningHours.$inject=["_"]}(),function(){"use strict";function filterByTag(){function filter(collection,tagName){var resultArray=[];if(collection)for(var i=0;i<collection.length;i++)for(var element=collection[i],j=0;j<element.tags.length;j++){var tag=element.tags[j];tag===tagName&&resultArray.push(element)}return resultArray}return filter}angular.module("app").filter("filterByTag",filterByTag)}(),function(){"use strict";function stateParamToText(){return function(param){return"faq"===param?"자주 묻는 질문":"notification"===param?"공지사항":void 0}}angular.module("app").filter("stateParamToText",stateParamToText),stateParamToText.$inject=[]}(),function(){"use strict";function BidDetailUserController(BidDetailUserModel,Preload){function preloadToPlaceDetail(){Preload.stateWithPlaces("main.placeDetail",{id:BidDetailUserModel.bid.place},!0,"forward")}var BidDetailUser=this;BidDetailUser.Model=BidDetailUserModel,BidDetailUser.preloadToPlaceDetail=preloadToPlaceDetail}angular.module("app").controller("BidDetailUserController",BidDetailUserController),
BidDetailUserController.$inject=["BidDetailUserModel","Preload"]}(),function(){"use strict";function BidDetailUserModel(){var model={bid:{}};return model}angular.module("app").factory("BidDetailUserModel",BidDetailUserModel),BidDetailUserModel.$inject=[]}(),function(){"use strict";function BidListUserController($scope,Bids,BidListUserModel,Preload,U,$state,appStorage,Distance){function refreshBids(){return Bids.find({product:$state.params.product,limit:10,sort:"updatedAt DESC",status:"responded",populates:["photos","owner","place","createdBy"]}).$promise.then(function(bidsWrapper){BidListUserModel.bids=bidsWrapper.bids,BidListUserModel.more=bidsWrapper.more;var currentLocation={longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1]};angular.forEach(BidListUserModel.bids,function(bid){var placeLocation={longitude:bid.place.geoJSON.coordinates[0],latitude:bid.place.geoJSON.coordinates[1]};bid.distanceFromCurrent=Distance.between(currentLocation,placeLocation)})})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),U.resize()})}function preloadToBidDetailUser(bid){return Preload.stateWithBids("main.bidDetailUser",{id:bid.id},!0,"forward")["catch"](U.error)}function getOlderBids(){var last=BidListUserModel.bids.length-1;return Bids.find({dateOlderThan:BidListUserModel.bids[last].updatedAt,product:$state.params.product,limit:10,status:"responded",sort:"updatedAt DESC",populates:["photos","owner","place","createdBy"]}).$promise.then(function(bidsWrapper){angular.forEach(bidsWrapper.bids,function(bid){BidListUserModel.bids.push(bid)}),BidListUserModel.more=bidsWrapper.more;var currentLocation={longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1]};angular.forEach(BidListUserModel.bids,function(bid){var placeLocation={longitude:bid.place.geoJSON.coordinates[0],latitude:bid.place.geoJSON.coordinates[1]};bid.distanceFromCurrent=Distance.between(currentLocation,placeLocation)})})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete"),U.resize()})}function onBeforeEnter(){var currentLocation={longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1]};angular.forEach(BidListUserModel.bids,function(bid){var placeLocation={longitude:bid.place.geoJSON.coordinates[0],latitude:bid.place.geoJSON.coordinates[1]};bid.distanceFromCurrent=Distance.between(currentLocation,placeLocation)}),U.resize()}var BidListUser=this;BidListUser.Model=BidListUserModel,BidListUser.refreshBids=refreshBids,BidListUser.preloadToBidDetailUser=preloadToBidDetailUser,BidListUser.getOlderBids=getOlderBids,$scope.$on("$ionicView.beforeEnter",onBeforeEnter)}angular.module("app").controller("BidListUserController",BidListUserController),BidListUserController.$inject=["$scope","Bids","BidListUserModel","Preload","U","$state","appStorage","Distance"]}(),function(){"use strict";function BidListUserModel(){var model={bids:[]};return model}angular.module("app").factory("BidListUserModel",BidListUserModel),BidListUserModel.$inject=[]}(),function(){"use strict";function MyProductListUserController(MyProductListUserModel,Products,appStorage,$ionicModal,$scope,U,Preload){function refreshProducts(){return Products.getProducts({createdBy:appStorage.user.id,category:"pawnShop",limit:10,sort:"id DESC",populates:["photos"]}).$promise.then(function(productsWrapper){MyProductListUserModel.products=productsWrapper.products,MyProductListUserModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete")})}function getOlderProducts(){var last=MyProductListUserModel.products.length-1;return Products.getProducts({createdBy:appStorage.user.id,category:"pawnShop",limit:10,olderThan:MyProductListUserModel.products[last].id,populates:["photos"]}).$promise.then(function(productsWrapper){angular.forEach(productsWrapper.products,function(product){MyProductListUserModel.products.push(product)}),MyProductListUserModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete")})}function deleteProduct(product,$index){Products.destroy({id:product.id}).$promise.then(function(product){MyProductListUserModel.products.splice($index,1),U.resize()})["catch"](U.error)}function preloadToBidListUser(product){Preload.stateWithBids("main.bidListUser",{product:product.id},!0)["catch"](U.error)}var MyProductListUser=this;MyProductListUser.Model=MyProductListUserModel,MyProductListUser.refreshProducts=refreshProducts,MyProductListUser.getOlderProducts=getOlderProducts,MyProductListUser.deleteProduct=deleteProduct,MyProductListUser.preloadToBidListUser=preloadToBidListUser,$scope.$on("$ionicView.beforeEnter",function(){U.resize()}),$ionicModal.fromTemplateUrl("state/10myProductList/modal/changeStateModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){MyProductListUser.changeStateModal=modal})}angular.module("app").controller("MyProductListUserController",MyProductListUserController),MyProductListUserController.$inject=["MyProductListUserModel","Products","appStorage","$ionicModal","$scope","U","Preload"]}(),function(){"use strict";function MyProductListUserModel(){var model={products:[],more:!1};return model}angular.module("app").factory("MyProductListUserModel",MyProductListUserModel),MyProductListUserModel.$inject=[]}(),function(){"use strict";function MyProductListPawnShopController(MyProductListPawnShopModel,Products,appStorage,$ionicModal,$scope,U,Preload,Message){function preloadToProductUpdateInfo(product){Preload.stateWithProducts("main.productUpdate.info",{category:"pawnShop",method:"update",section:"info",step:1,id:product.id},!0,"forward")["catch"](U.error)}function refreshProducts(){return Products.getProducts({createdBy:appStorage.user.id,category:"market",limit:10,sort:"id DESC",populates:["photos"]}).$promise.then(function(productsWrapper){MyProductListPawnShopModel.products=productsWrapper.products,MyProductListPawnShopModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete")})}function getOlderProducts(){var last=MyProductListPawnShopModel.products.length-1;return Products.getProducts({createdBy:appStorage.user.id,category:"market",limit:10,olderThan:MyProductListPawnShopModel.products[last].id,populates:["photos"]}).$promise.then(function(productsWrapper){angular.forEach(productsWrapper.products,function(product){MyProductListPawnShopModel.products.push(product)}),MyProductListPawnShopModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete")})}function deleteProduct(product,$index){Products.destroy({id:product.id}).$promise.then(function(product){MyProductListPawnShopModel.products.splice($index,1),U.resize()})["catch"](U.error)}function preloadToBidListUser(product){Preload.stateWithBids("main.bidListUser",{productId:product.id},!0)["catch"](U.error)}function changeState(state){Products.updateProduct({},{id:MyProductListPawnShopModel.selectedProduct.id,status:state}).$promise.then(function(products){MyProductListPawnShopModel.selectedProduct.status=products[0].status,refreshProducts(),MyProductListPawnShop.changeStateModal.hide()})["catch"](function(err){MyProductListPawnShop.changeStateModal.hide(),Message.alert()})}function showChangeStateModal(product){MyProductListPawnShopModel.selectedProduct=product,MyProductListPawnShop.changeStateModal.show()}var MyProductListPawnShop=this;MyProductListPawnShop.Model=MyProductListPawnShopModel,MyProductListPawnShop.refreshProducts=refreshProducts,MyProductListPawnShop.getOlderProducts=getOlderProducts,MyProductListPawnShop.deleteProduct=deleteProduct,MyProductListPawnShop.preloadToBidListUser=preloadToBidListUser,MyProductListPawnShop.preloadToProductUpdateInfo=preloadToProductUpdateInfo,MyProductListPawnShop.showChangeStateModal=showChangeStateModal,MyProductListPawnShop.changeState=changeState,$scope.$on("$ionicView.beforeEnter",function(){U.resize()}),$ionicModal.fromTemplateUrl("state/10myProductList/modal/changeStateModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){MyProductListPawnShop.changeStateModal=modal})}angular.module("app").controller("MyProductListPawnShopController",MyProductListPawnShopController),MyProductListPawnShopController.$inject=["MyProductListPawnShopModel","Products","appStorage","$ionicModal","$scope","U","Preload","Message"]}(),function(){"use strict";function MyProductListPawnShopModel(){var model={products:[],more:!1,selectedProduct:{}};return model}angular.module("app").factory("MyProductListPawnShopModel",MyProductListPawnShopModel),MyProductListPawnShopModel.$inject=[]}(),function(){"use strict";function ProductUpdateInfoController(ProductUpdateModel,Message,U,$scope){var ProductUpdateInfo=this;ProductUpdateInfo.Model=ProductUpdateModel,$scope.$on("$ionicView.beforeEnter",function(){U.resize()})}angular.module("app").controller("ProductUpdateInfoController",ProductUpdateInfoController),ProductUpdateInfoController.$inject=["ProductUpdateModel","Message","U","$scope"]}(),function(){"use strict";function ProductUpdatePhotoController(ProductUpdateModel,Message,U,$scope){function getImage(length,sourceType){validateImage(length)&&ImageService.get({from:sourceType,fileUris:ProductUpdateModel.fileUris,dataUris:ProductUpdateModel.dataUris})}function validateImage(length){Message.alert.bind(null,"사진등록 알림");if(1!==length&&!ProductUpdateModel.dataUris[length-2]){if(2===length)return!1;if(3===length)return!1;if(4===length)return!1;if(5===length)return!1}return!0}var ProductUpdatePhoto=this;ProductUpdatePhoto.Model=ProductUpdateModel,ProductUpdatePhoto.getImage=getImage,$scope.$on("$ionicView.beforeEnter",function(){U.resize()})}angular.module("app").controller("ProductUpdatePhotoController",ProductUpdatePhotoController),ProductUpdatePhotoController.$inject=["ProductUpdateModel","Message","U","$scope"]}(),function(){"use strict";function BidDetailPawnShopPendingController(BidDetailPawnShopPendingModel,Bids,$state,U,Message,Preload){function updateBid(){Message.loading();var query={};return angular.extend(query,BidDetailPawnShopPendingModel.form),query.id=$state.params.id,query.status="responded",Bids.update({},query).$promise.then(function(bid){return Preload.stateWithBids("main.bidListPawnShopResponded",{category:"pawnShop",status:"responded"},!1)}).then(function(){return Message.hide(),Message.alert("견적보내기 알림","견적을 성공적으로 보냈습니다.")}).then(function(){U.goToState("main.bidListPawnShopResponded",{category:"pawnShop",status:"responded"},"forward")})["catch"](U.error)}var BidDetailPawnShopPending=this;BidDetailPawnShopPending.Model=BidDetailPawnShopPendingModel,BidDetailPawnShopPending.updateBid=updateBid}angular.module("app").controller("BidDetailPawnShopPendingController",BidDetailPawnShopPendingController),BidDetailPawnShopPendingController.$inject=["BidDetailPawnShopPendingModel","Bids","$state","U","Message","Preload"]}(),function(){"use strict";function BidDetailPawnShopPendingModel(){var model={bid:{},form:{}};return model}angular.module("app").factory("BidDetailPawnShopPendingModel",BidDetailPawnShopPendingModel),BidDetailPawnShopPendingModel.$inject=[]}(),function(){"use strict";function BidDetailPawnShopRespondedController(BidDetailPawnShopRespondedModel){var BidDetailPawnShopResponded=this;BidDetailPawnShopResponded.Model=BidDetailPawnShopRespondedModel}angular.module("app").controller("BidDetailPawnShopRespondedController",BidDetailPawnShopRespondedController),BidDetailPawnShopRespondedController.$inject=["BidDetailPawnShopRespondedModel"]}(),function(){"use strict";function BidDetailPawnShopRespondedModel(){var model={bid:{}};return model}angular.module("app").factory("BidDetailPawnShopRespondedModel",BidDetailPawnShopRespondedModel),BidDetailPawnShopRespondedModel.$inject=[]}(),function(){"use strict";function BidListPawnShopPendingController(BidListPawnShopPendingModel,Bids,appStorage,U,Preload,$scope){function refreshBids(){return Bids.find({owner:appStorage.place.owner,limit:10,status:"pending",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){BidListPawnShopPendingModel.bids=bidsWrapper.bids,BidListPawnShopPendingModel.more=bidsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),U.resize()})}function preloadToBidDetailPawnShopPending(bid){Preload.stateWithBids("main.bidDetailPawnShopPending",{id:bid.id},!0,"foward")["catch"](U.error)}function deleteBid(bid,$index){return Bids.destroy({id:bid.id}).$promise.then(function(bid){BidListPawnShopPendingModel.bids.splice($index,1),U.resize()})["catch"](U.error)["finally"](function(){U.resize()})}function getOlderBids(){var last=BidListPawnShopPendingModel.bids.length-1;return Bids.find({olderThan:BidListPawnShopPendingModel.bids[last].id,owner:appStorage.place.owner,limit:10,status:"pending",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){angular.forEach(bidsWrapper.bids,function(bid){BidListPawnShopPendingModel.bids.push(bid)}),BidListPawnShopPendingModel.more=bidsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete"),U.resize()})}var BidListPawnShopPending=this;BidListPawnShopPending.Model=BidListPawnShopPendingModel,BidListPawnShopPending.refreshBids=refreshBids,BidListPawnShopPending.getOlderBids=getOlderBids,BidListPawnShopPending.deleteBid=deleteBid,BidListPawnShopPending.preloadToBidDetailPawnShopPending=preloadToBidDetailPawnShopPending,$scope.$on("$ionicView.beforeEnter",function(){U.resize()})}angular.module("app").controller("BidListPawnShopPendingController",BidListPawnShopPendingController),BidListPawnShopPendingController.$inject=["BidListPawnShopPendingModel","Bids","appStorage","U","Preload","$scope"]}(),function(){"use strict";function BidListPawnShopPendingModel(){var model={bids:[],more:!1};return model}angular.module("app").factory("BidListPawnShopPendingModel",BidListPawnShopPendingModel),BidListPawnShopPendingModel.$inject=[]}(),function(){"use strict";function BidListPawnShopRespondedController(BidListPawnShopRespondedModel,Bids,appStorage,U,Preload,$scope){function refreshBids(){return Bids.find({owner:appStorage.place.owner,limit:10,status:"responded",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){BidListPawnShopRespondedModel.bids=bidsWrapper.bids,BidListPawnShopRespondedModel.more=bidsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),U.resize()})}function preloadToBidDetailPawnShopResponded(bid){Preload.stateWithBids("main.bidDetailPawnShopResponded",{id:bid.id},!0,"forward")["catch"](U.error)}function deleteBid(bid,$index){return Bids.destroy({id:bid.id}).$promise.then(function(bid){BidListPawnShopRespondedModel.bids.splice($index,1),U.resize()})["catch"](U.error)["finally"](function(){U.resize()})}function getOlderBids(){var last=BidListPawnShopRespondedModel.bids.length-1;return Bids.find({olderThan:BidListPawnShopRespondedModel.bids[last].id,owner:appStorage.place.owner,limit:10,status:"pending",sort:"id DESC",populates:["photos","createdBy"]}).$promise.then(function(bidsWrapper){angular.forEach(bidsWrapper.bids,function(bid){BidListPawnShopRespondedModel.bids.push(bid)}),BidListPawnShopRespondedModel.more=bidsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete"),U.resize()})}var BidListPawnShopResponded=this;BidListPawnShopResponded.Model=BidListPawnShopRespondedModel,BidListPawnShopResponded.refreshBids=refreshBids,BidListPawnShopResponded.getOlderBids=getOlderBids,BidListPawnShopResponded.deleteBid=deleteBid,BidListPawnShopResponded.preloadToBidDetailPawnShopResponded=preloadToBidDetailPawnShopResponded,$scope.$on("$ionicView.beforeEnter",function(){U.resize()})}angular.module("app").controller("BidListPawnShopRespondedController",BidListPawnShopRespondedController),BidListPawnShopRespondedController.$inject=["BidListPawnShopRespondedModel","Bids","appStorage","U","Preload","$scope"]}(),function(){"use strict";function BidListPawnShopRespondedModel(){var model={bids:[],more:!1};return model}angular.module("app").factory("BidListPawnShopRespondedModel",BidListPawnShopRespondedModel),BidListPawnShopRespondedModel.$inject=[]}(),function(){"use strict";function MainController(Products,MainModel,$scope,appStorage,$state,$ionicSideMenuDelegate,$ionicModal,$stateParams,Message,U,AppService,Preload,$localStorage,appName){function logout(stateAfterLogout){$localStorage[appName]={geoJSON:{type:"Point",coordinates:[127.02800027507125,37.498085435791786]},marketDistance:8e3,pawnShopDistance:5e3,address:"강남역",firstTime:!1},$ionicSideMenuDelegate.toggleLeft(!1),$state.go(stateAfterLogout)}function getMyPawnShopProducts(){return AppService.getMyPawnShopProducts().then(function(){return U.goToState("main.myProductList",{category:"pawnShop"})})["catch"](U.error)}function preloadToMyProductListUser(){return Preload.stateWithProducts("main.myProductListUser",{category:"user"},!0,"forward")["catch"](U.error)}function preloadToMyProductListPawnShop(){return Preload.stateWithProducts("main.myProductListPawnShop",{category:"pawnShop"},!0,"forward")["catch"](U.error)}function preloadToBidListPawnShopPending(){return Preload.stateWithBids("main.bidListPawnShopPending",{category:"pawnShop",status:"pending"},!0,"forward")["catch"](U.error)}function preloadToBidListPawnShopResponded(){return Preload.stateWithBids("main.bidListPawnShopResponded",{category:"pawnShop",status:"responded"},!0,"forward")["catch"](U.error)}function preloadToFavoriteProductList(){return Preload.stateWithProducts("main.favoriteProductList",{},!0,"forward")["catch"](U.error)}var Main=this;Main.Model=MainModel,Main.logout=logout,Main.getMyPawnShopProducts=getMyPawnShopProducts,Main.preloadToMyProductListUser=preloadToMyProductListUser,Main.preloadToMyProductListPawnShop=preloadToMyProductListPawnShop,Main.preloadToBidListPawnShopPending=preloadToBidListPawnShopPending,Main.preloadToBidListPawnShopResponded=preloadToBidListPawnShopResponded,Main.preloadToFavoriteProductList=preloadToFavoriteProductList,$ionicModal.fromTemplateUrl("state/modal/requestLogin.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){Main.requestLoginModal=modal})}angular.module("app").controller("MainController",MainController),MainController.$inject=["Products","MainModel","$scope","appStorage","$state","$ionicSideMenuDelegate","$ionicModal","$stateParams","Message","U","AppService","Preload","$localStorage","appName"]}(),function(){"use strict";function MainModel(){var model={};return model}angular.module("app").factory("MainModel",MainModel),MainModel.$inject=[]}(),function(){"use strict";function WalkThroughController($scope,WalkThroughModel,$ionicSlideBoxDelegate,$window,$state,$ionicGesture,appStorage){function onSlideChange($index){}function onBeforeEnter(){$ionicSlideBoxDelegate.$getByHandle("walk-through-slide").update(),$ionicSlideBoxDelegate.$getByHandle("walk-through-slide").slide(0,0),$ionicSlideBoxDelegate.$getByHandle("walk-through-slide").enableSlide(!0)}function onEnter(){var lastSlideIndex=WalkThroughModel.imagePaths.length-1,lastSlideElement=angular.element($window.document.querySelector("#slide"+lastSlideIndex));$ionicGesture.on("swipeleft",leaveWalkThrough,lastSlideElement)}function leaveWalkThrough(){appStorage.firstTime=!1,$state.go("main.login")}var WalkThrough=this;WalkThrough.Model=WalkThroughModel,WalkThrough.leaveWalkThrough=leaveWalkThrough,WalkThrough.onSlideChange=onSlideChange,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.enter",onEnter)}angular.module("app").controller("WalkThroughController",WalkThroughController),WalkThroughController.$inject=["$scope","WalkThroughModel","$ionicSlideBoxDelegate","$window","$state","$ionicGesture","appStorage"]}(),function(){"use strict";function WalkThroughModel(){var model={imagePaths:["img/walkthrough_01.png","img/walkthrough_02.png","img/walkthrough_03.png"]};return model}angular.module("app").factory("WalkThroughModel",WalkThroughModel),WalkThroughModel.$inject=[]}(),function(){"use strict";function LoginController($scope,Users,Places,LoginModel,Message,appStorage,$state,$q,Preload,U,Devices){function login(){return Message.loading(),Users.login({},{identifier:LoginModel.form.email,password:LoginModel.form.password}).$promise.then(function(authData){return appStorage.token=authData.token,appStorage.user=authData.user,appStorage.user}).then(function(userData){return Places.getPlaces({owner:userData.id}).$promise}).then(function(placesWrapper){if(0===placesWrapper.places.length&&"pawnShop"===appStorage.user.role){var placeData=getPlaceDataFromUser(appStorage.user);return $q.all([Places.createPlace({},placeData).$promise])}return placesWrapper.places}).then(function(places){appStorage.place=places[0]||[];var params={};return"user"===appStorage.user.role?params.category="market":"pawnShop"===appStorage.user.role&&(params.category="pawnShop"),Preload.stateWithProducts("main.productList."+params.category,params,!1)}).then(function(){return Devices.update(null,{deviceId:appStorage.deviceId||"nil",user:appStorage.user.id})}).then(function(){appStorage.deviceUpdateDone=!0}).then(function(){var params={};return"user"===appStorage.user.role?params.category="market":"pawnShop"===appStorage.user.role&&(params.category="pawnShop"),U.goToState("main.productList."+params.category,params,"forward")})["catch"](function(err){Message.hide(),Message.alert("로그인 알림","이메일이나 암호가 잘못 되었습니다.").then(function(){LoginModel.form={}})})}function lookAround(){return appStorage.user||(appStorage.user={}),appStorage.user.role="user",appStorage.user.lookAround=!0,Preload.stateWithProducts("main.productList.market",{category:"market"},!0,"forward")["catch"](U.error)}function onEnter(){LoginModel.form={}}function getPlaceDataFromUser(user){var place={};return angular.extend(place,user),delete place.id,delete place.createdAt,delete place.exp,delete place.gravatarUrl,delete place.iat,delete place.role,delete place.rol,delete place.updatedAt,delete place.username,place.description="업데이트 해주세요.",place.category="pawnShop",place}var Login=this;Login.Model=LoginModel,Login.login=login,Login.lookAround=lookAround,$scope.$on("$ionicView.enter",onEnter)}angular.module("app").controller("LoginController",LoginController),LoginController.$inject=["$scope","Users","Places","LoginModel","Message","appStorage","$state","$q","Preload","U","Devices"]}(),function(){"use strict";function LoginModel(){var model={form:{username:null,email:null,password:null}};return model}angular.module("app").factory("LoginModel",LoginModel),LoginModel.$inject=[]}(),function(){"use strict";function ResetPasswordController(ResetPasswordModel,Message,Users,U,$scope){function sendForm(){return validate()?void Users.changePassword({},ResetPasswordModel.form).$promise.then(function(message){return Message.alert("비밀번호변경 알림",message.message)}).then(function(){U.goBack()})["catch"](function(err){ResetPasswordModel.form={},ResetPasswordModel.confirmPassword=null,Message.alert("비밀번호변경 알림",err.data.message)}):!1}function validate(){var form=ResetPasswordModel.form;return form.newPassword!==ResetPasswordModel.confirmPassword?(Message.alert("비민번호 변경 알림","새 비밀번호와 재입력한 비밀번호가 다릅니다."),ResetPasswordModel.form={},ResetPasswordModel.confirmPassword=null,!1):!0}var ResetPassword=this;ResetPassword.Model=ResetPasswordModel,ResetPassword.sendForm=sendForm,$scope.$on("$ionicView.beforeEnter",function(){ResetPasswordModel.form={},ResetPasswordModel.confirmPassword=null})}angular.module("app").controller("ResetPasswordController",ResetPasswordController),ResetPasswordController.$inject=["ResetPasswordModel","Message","Users","U","$scope"]}(),function(){"use strict";function ResetPasswordModel(){var model={form:{oldPassword:null,newPassword:null},confirmPassword:null};return model}angular.module("app").factory("ResetPasswordModel",ResetPasswordModel),ResetPasswordModel.$inject=[]}(),function(){"use strict";function SignUpController($scope,Users,Places,SignUpModel,Message,U,$state,daum,$ionicScrollDelegate,appStorage,$q,Preload,Devices){function checkEmail(){return Message.loading(),Users.checkEmail({email:SignUpModel.form.email}).$promise.then(function(data){data.isAvailable?(SignUpModel.checkedEmail=!0,Message.alert("비밀번호 중복확인 알림","사용가능한 이메일 입니다.")):(SignUpModel.checkedEmail=!1,Message.alert("비밀번호 중복확인 알림","이미 사용중인 이메일 입니다."))})["catch"](function(err){SignUpModel.checkedEmail=!1,Message.alert("비밀번호 중복확인 알림","이메일을 입력해주세요.")})["finally"](function(){Message.hide()})}function searchPlace(){if(!SignUpModel.form.address)return!1;var ps=new daum.maps.services.Places;Message.loading(),ps.keywordSearch(SignUpModel.form.address,function(status,data){return Message.hide(),void 0===data.places[0]?(Message.alert("요청하신 장소가 없습니다","다시검색해주세요"),!1):void(SignUpModel.places=data.places)},function(err){Message.hide(),Message.alert()})}function selectPlace(placeObj){SignUpModel.form.address=placeObj.address,SignUpModel.form.geoJSON={type:"Point",coordinates:[Number(placeObj.longitude),Number(placeObj.latitude)]},SignUpModel.places=[],$ionicScrollDelegate.resize()}function signUp(category){var promise;if(SignUpModel.form.username=SignUpModel.form.email,!validateForm(category))return!1;if(Message.loading(),"user"===category)SignUpModel.form.role="user",promise=Users.register({},SignUpModel.form).$promise;else{if("pawnShop"!==category)return Message.alert("something is wrong","SignUp.signUp");SignUpModel.form.role="pawnShop",promise=Users.registerPlaceOwner({},SignUpModel.form).$promise}return promise.then(function(userData){return Message.hide(),Message.alert("회원가입 성공","회원가입을 성공하였습니다.")}).then(function(alertResponse){return login(SignUpModel.form.email,SignUpModel.form.password)})["catch"](function(err){return Message.hide(),reset(),Message.alert("가입실패","다시 입력해주세요")})}function onBeforeEnter(){reset()}function login(identifier,password){return Message.loading(),Users.login({},{identifier:identifier,password:password}).$promise.then(function(authData){return appStorage.token=authData.token,appStorage.user=authData.user,appStorage.user}).then(function(userData){return Places.getPlaces({owner:userData.id}).$promise}).then(function(placesWrapper){if(0===placesWrapper.places.length&&"pawnShop"===appStorage.user.role){var placeData=getPlaceDataFromUser(appStorage.user);return $q.all([Places.createPlace({},placeData).$promise])}return placesWrapper.places}).then(function(places){appStorage.place=places[0]||[];var params={};return"user"===appStorage.user.role?params.category="market":"pawnShop"===appStorage.user.role&&(params.category="pawnShop"),Preload.stateWithProducts("main.productList."+params.category,params,!1)}).then(function(){return Devices.update(null,{deviceId:appStorage.deviceId||"nil",user:appStorage.user.id})}).then(function(){appStorage.deviceUpdateDone=!0}).then(function(){var params={};return"user"===appStorage.user.role?params.category="market":"pawnShop"===appStorage.user.role&&(params.category="pawnShop"),U.goToState("main.productList."+params.category,params,"forward")})}function getPlaceDataFromUser(user){var place={};return angular.extend(place,user),delete place.id,delete place.createdAt,delete place.exp,delete place.gravatarUrl,delete place.iat,delete place.role,delete place.rol,delete place.updatedAt,delete place.username,place.description="업데이트 해주세요.",place.category="pawnShop",place}function validateForm(category){var form=(Message.alert.bind(null,"가입신청 알림"),SignUpModel.form);return"user"===category?form.nickname?form.nickname.length<4?!1:form.email&&SignUpModel.checkedEmail&&form.password?form.password!==SignUpModel.confirmPassword?!1:SignUpModel.termsAgreed?!0:!1:!1:!1:"pawnShop"===category?form.name&&form.email&&SignUpModel.checkedEmail&&form.password?form.password!==SignUpModel.confirmPassword?!1:form.cellPhone&&form.phone&&form.companyNumber&&form.address&&form.geoJSON&&SignUpModel.termsAgreed?!0:!1:!1:void 0}function reset(){SignUpModel.form={},SignUpModel.confirmPassword=null}var SignUp=this;SignUp.Model=SignUpModel,SignUp.signUp=signUp,SignUp.searchPlace=searchPlace,SignUp.selectPlace=selectPlace,SignUp.checkEmail=checkEmail,$scope.$on("$ionicView.beforeEnter",onBeforeEnter)}angular.module("app").controller("SignUpController",SignUpController),SignUpController.$inject=["$scope","Users","Places","SignUpModel","Message","U","$state","daum","$ionicScrollDelegate","appStorage","$q","Preload","Devices"]}(),function(){"use strict";function SignUpModel(){var model={form:{nickname:null,email:null,username:null,password:null},confirmPassword:null,checkedEmail:!1,termsAgreed:!1};return model}angular.module("app").factory("SignUpModel",SignUpModel),SignUpModel.$inject=[]}(),function(){"use strict";function ProfileController(U,$scope,Places,Users,ProfileModel,Message,ImageService,$ionicSlideBoxDelegate,$timeout,appStorage,$state,Preload,$q,daum){function onBeforeEnter(){U.areSiblingViews(noLoadingStates)||(ProfileModel.loading=!0)}function onAfterEnter(){return U.areSiblingViews(noLoadingStates)||"user"!==$state.params.category?void(U.areSiblingViews(noLoadingStates)||"pawnShop"!==$state.params.category||$q.all([findOnePlaceOwner(),findOnePlace()]).then(function(array){var placeOwner=array[0],place=array[1];U.bindData(placeOwner,ProfileModel,"user"),U.bindData(place,ProfileModel,"place")})["catch"](U.error)):findOneUser().then(function(user){U.bindData(user,ProfileModel,"user")})["catch"](U.error)}function sendFormUser(){var nickname=ProfileModel.user.nickname,email=ProfileModel.user.email,username=ProfileModel.user.email;return updateUser({id:$state.params.id,nickname:nickname,email:email,username:username}).then(function(user){U.bindData(user,ProfileModel,"user"),appStorage.user.nickname=user.nickname,appStorage.user.email=user.email,appStorage.user.username=user.username,Message.alert("프로필 수정 알림","업데이트가 완료 되었습니다.")})["catch"](U.error)}function findOneUser(extraQuery){var query={id:$state.params.id,populates:["roles"]};return angular.extend(query,extraQuery),Users.findOne(query).$promise.then(function(user){var photosPromise=Preload.photos(user,"cloudinary200",!1);return $q.all([user,photosPromise])}).then(function(array){var user=array[0];return user})}function updateUser(extraQuery){var query={id:$state.params.id};return angular.extend(query,extraQuery),Users.update(query).$promise.then(function(user){var photosPromise=Preload.photos(user,"cloudinary600",!1);return $q.all([user,photosPromise])}).then(function(array){var user=array[0];return user})}function findOnePlaceOwner(extraQuery){var query={id:$state.params.id};return angular.extend(query,extraQuery),Users.findOne(query).$promise.then(function(placeOwner){var photosPromise=Preload.photos(placeOwner,"cloudinary600",!1);return $q.all([placeOwner,photosPromise])}).then(function(array){var placeOwner=array[0];return placeOwner})}function findOnePlace(extraQuery){var query={id:appStorage.place.id,populates:["photos"]};return angular.extend(query,extraQuery),Places.findOne(query).$promise.then(function(place){var photosPromise=Preload.photos(place,"cloudinary600",!1);return $q.all([place,photosPromise])}).then(function(array){var place=array[0];return place})}function getImage(sourceType){return ImageService.get({from:sourceType,fileUris:ProfileModel.fileUris,dataUris:ProfileModel.dataUris}).then(function(){$timeout(function(){$ionicSlideBoxDelegate.$getByHandle("update-slide").update()},0)})}function updatePlaceOwner(extraQuery){var query={id:$state.params.id};return angular.extend(query,extraQuery),Users.update(query).$promise.then(function(user){var photosPromise=Preload.photos(user,"cloudinary600",!1);return $q.all([user,photosPromise])}).then(function(array){var user=array[0];return user});
}function sendFormPlace(){delete ProfileModel.user.$promise,delete ProfileModel.user.$resolved,delete ProfileModel.user.createdAt,delete ProfileModel.user.gravatarUrl,delete ProfileModel.user.owner,delete ProfileModel.user.updatedAt,delete ProfileModel.user.geoJSON,ProfileModel.user.username=ProfileModel.user.email;var placeOwnerPromise=updatePlaceOwner(ProfileModel.user),placeId=ProfileModel.place.id;angular.extend(ProfileModel.place,ProfileModel.user),ProfileModel.place.id=placeId,delete ProfileModel.place.$promise,delete ProfileModel.place.$resolved,delete ProfileModel.place.createdAt,delete ProfileModel.place.gravatarUrl,delete ProfileModel.place.owner,delete ProfileModel.place.updatedAt,delete ProfileModel.place.geoJSON,(ProfileModel.dataUris.length>0||0===ProfileModel.place.photos.length)&&delete ProfileModel.place.photos;var placePromise=ImageService.post({url:"/place",dataUris:ProfileModel.dataUris,fields:ProfileModel.place},"PUT");$q.all([placeOwnerPromise,placePromise]).then(function(array){var placeOwner=array[0],place=array[1].data[0];return appStorage.place=place,appStorage.user=placeOwner,ProfileModel.user=placeOwner,ProfileModel.place=place,ProfileModel.place.photos||(ProfileModel.place.photos=[]),ProfileModel.dataUris=[],ProfileModel.fileUris=[],Message.alert("프로필 수정 알림","업데이트가 완료 되었습니다.")})["catch"](function(err){Message.alert()})}var Profile=this;Profile.Model=ProfileModel;var noLoadingStates=["main.resetPassword"];Profile.sendFormUser=sendFormUser,Profile.getImage=getImage,Profile.sendFormPlace=sendFormPlace,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("ProfileController",ProfileController),ProfileController.$inject=["U","$scope","Places","Users","ProfileModel","Message","ImageService","$ionicSlideBoxDelegate","$timeout","appStorage","$state","Preload","$q","daum"]}(),function(){"use strict";function ProfileModel(){var model={fileUris:[],dataUris:[],place:{photos:[],name:"착한 전당포",email:"niceshop@shop.co.kr",password:"",confirmPassword:"",cellPhone:1012341234,phone:212345678,companyNumber:"2013-서울강남-0123",address:"서울특별시 서초구 신반포로 177 6층 203호",openingHours:"일요일: 5시 평일 9시",description:"컴퓨터(아이맥/레노버/삼성/엘지)등\n패드(갤럭시 노트패드 / 아이패드)등\n여러물품 취급합니다."},user:{}};return model}angular.module("app").factory("ProfileModel",ProfileModel),ProfileModel.$inject=[]}(),function(){"use strict";function CustomerController($scope,$state,CustomerModel,Message,appStorage,Contacts){function onAfterEnter(){Message.hide()}function sendForm(){return appStorage.token?(Message.loading(),void Contacts.contactAdmin({},CustomerModel.form).$promise.then(function(){CustomerModel.form={},Message.hide(),Message.alert("고객문의 알림","고객문의가 성공적으로 접수 되었습니다. 가입하신 이메일로 연락 드리겠습니다.").then(function(){$state.go("main.productList.market")})})["catch"](function(err){Message.hide(),Message.alert("고객문의 알림","제목과 내용은 필수 사항입니다.")})):Message.alert("고객센터 알림","로그인/회원가입을 하셔야 합니다.").then(function(){$state.go("main.login")})}var Customer=this;Customer.Model=CustomerModel,Customer.sendForm=sendForm,$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("CustomerController",CustomerController),CustomerController.$inject=["$scope","$state","CustomerModel","Message","appStorage","Contacts"]}(),function(){"use strict";function CustomerModel(){var model={form:{email:"",phone:"",title:"",content:""}};return model}angular.module("app").factory("CustomerModel",CustomerModel),CustomerModel.$inject=[]}(),function(){"use strict";function TermDetailController($scope,TermDetailModel,Posts,Message,U,Preload,$q){function onBeforeEnter(){}function onAfterEnter(){}function refresh(){}var TermDetail=this;TermDetail.Model=TermDetailModel,TermDetail.refresh=refresh,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("TermDetailController",TermDetailController),TermDetailController.$inject=["$scope","TermDetailModel","Posts","Message","U","Preload","$q"]}(),function(){"use strict";function TermDetailModel(){var model={post:{}};return model}angular.module("app").factory("TermDetailModel",TermDetailModel),TermDetailModel.$inject=[]}(),function(){"use strict";function HomeController(HomeModel){var Home=this;Home.Model=HomeModel}angular.module("app").controller("HomeController",HomeController),HomeController.$inject=["HomeModel"]}(),function(){"use strict";function HomeModel(){var model={};return model}angular.module("app").factory("HomeModel",HomeModel),HomeModel.$inject=[]}(),function(){"use strict";function BidDetailController(U,$scope,Bids,BidDetailModel,Message,$stateParams,$ionicSlideBoxDelegate){function getBid(){return Bids.findById({id:$stateParams.id,populates:"createdBy,place,product"}).$promise.then(setView)["catch"](findByIdError)}function onBeforeEnter(){}function onBeforeLeave(){return Message.loading()}function onAfterEnter(){return $ionicSlideBoxDelegate.update(),$ionicSlideBoxDelegate.slide(0,0),$ionicSlideBoxDelegate.enableSlide(!0),Message.hide()}function setView(bid){return BidDetailModel.bid=bid,$scope.$broadcast("scroll.refreshComplete"),U.resize(),Message.hide()}function findByIdError(err){return $scope.$broadcast("scroll.refreshComplete"),Message.alert()}var BidDetail=this;BidDetail.Model=BidDetailModel,BidDetail.getBid=getBid,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.beforeLeave",onBeforeLeave),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("BidDetailController",BidDetailController),BidDetailController.$inject=["U","$scope","Bids","BidDetailModel","Message","$stateParams","$ionicSlideBoxDelegate"]}(),function(){"use strict";function BidDetailModel(){var model={bid:{id:"asdf",price:25e4,monthlyInterest:1.2,duration:3,canPickUp:!0,createdAt:"2015.08.20",createdBy:{nickname:"닉네임"},place:{name:"착한전당포"},product:{photos:[{url:"http://placehold.it/500x400"},{url:"http://placehold.it/500x400"}],name:"아이패등",brand:"애플",boughtAt:"2015.11.11",condition:"상"}}};return model}angular.module("app").factory("BidDetailModel",BidDetailModel),BidDetailModel.$inject=[]}(),function(){"use strict";function BidRequestController(U,$scope,Posts,BidRequestModel,Message,$stateParams){function getPost(){return Posts.findById({id:$stateParams.id,populates:"photos"}).$promise.then(setView)["catch"](findByIdError)}function onBeforeEnter(){return U.reset(BidRequestModel),getPost()}function onBeforeLeave(){return Message.loading()}function onAfterEnter(){return Message.hide()}function setView(post){return BidRequestModel.post=post,U.resize(),Message.hide()}function findByIdError(err){return Message.alert()}var BidRequest=this;BidRequest.Model=BidRequestModel,BidRequest.getPost=getPost,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.beforeLeave",onBeforeLeave),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("BidRequestController",BidRequestController),BidRequestController.$inject=["U","$scope","Posts","BidRequestModel","Message","$stateParams"]}(),function(){"use strict";function BidRequestModel(){var model={form:{}};return model}angular.module("app").factory("BidRequestModel",BidRequestModel),BidRequestModel.$inject=[]}(),function(){"use strict";function BidRespondController(U,$scope,Bids,BidRespondModel,Message,$stateParams,$ionicSlideBoxDelegate){function getBid(){return Bids.findById({id:$stateParams.id,populates:"createdBy,place,product"}).$promise.then(setView)["catch"](findByIdError)}function respondToBid(){var ok=validateBid();return ok?(BidRespondModel.form.status="responded",Bids.updateBid({id:$stateParams.id},BidRespondModel.form).$promise.then(respondToBidSuccess)["catch"](updateBidError)):!1}function onBeforeEnter(){}function onBeforeLeave(){return Message.loading()}function onAfterEnter(){return $ionicSlideBoxDelegate.update(),$ionicSlideBoxDelegate.slide(0,0),$ionicSlideBoxDelegate.enableSlide(!0),Message.hide()}function setView(bid){Message.hide()}function findByIdError(err){return Message.alert()}function validateBid(){var form=BidRespondModel.form;return form.price&&form.monthlyInterest&&form.duration?"boolean"!=typeof form.canPickUp?!1:!0:!1}function respondToBidSuccess(bid){Message.alert("견적 보네기 알림","견적이 보네졌습니다.")}function updateBidError(err){return Message.alert()}var BidRespond=this;BidRespond.Model=BidRespondModel,BidRespond.getBid=getBid,BidRespond.respondToBid=respondToBid,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.beforeLeave",onBeforeLeave),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("BidRespondController",BidRespondController),BidRespondController.$inject=["U","$scope","Bids","BidRespondModel","Message","$stateParams","$ionicSlideBoxDelegate"]}(),function(){"use strict";function BidRespondModel(){var model={bid:{id:"asdf",createdAt:"2015.08.20",createdBy:{nickname:"닉네임"},place:{name:"착한전당포"},product:{photos:[{url:"http://placehold.it/500x400"},{url:"http://placehold.it/500x400"}],name:"아이패등",brand:"애플",boughtAt:"2015.11.11",condition:"상"}},form:{price:null,monthlyInterest:null,duration:null,canPickUp:null}};return model}angular.module("app").factory("BidRespondModel",BidRespondModel),BidRespondModel.$inject=[]}(),function(){"use strict";function FavoriteProductDetailController(U,$scope,Products,FavoriteProductDetailModel,Message,$stateParams,FavoriteService,$state,$ionicSlideBoxDelegate,LinkService,Preload){function preloadToPlaceDetail(){Preload.stateWithPlaces("main.placeDetail",{id:FavoriteProductDetailModel.product.place.id},!0,"forward")}function onBeforeEnter(){U.update(),U.resize()}function onLeave(){U.resetSlides()}var FavoriteProductDetail=this;FavoriteProductDetail.Model=FavoriteProductDetailModel,FavoriteProductDetail.isFavorite=FavoriteService.isFavorite,FavoriteProductDetail.toggleProduct=FavoriteService.toggleProduct,FavoriteProductDetail.call=LinkService.call,FavoriteProductDetail.preloadToPlaceDetail=preloadToPlaceDetail,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.beforeLeave",onLeave)}angular.module("app").controller("FavoriteProductDetailController",FavoriteProductDetailController),FavoriteProductDetailController.$inject=["U","$scope","Products","FavoriteProductDetailModel","Message","$stateParams","FavoriteService","$state","$ionicSlideBoxDelegate","LinkService","Preload"]}(),function(){"use strict";function FavoriteProductDetailModel(){var model={product:{place:{},photos:[],createdBy:{}}};return model}angular.module("app").factory("FavoriteProductDetailModel",FavoriteProductDetailModel),FavoriteProductDetailModel.$inject=[]}(),function(){"use strict";function FavoriteProductListController(Products,U,FavoriteProductListModel,appStorage,$scope,Preload){function preloadToFavoriteProductDetail(product){return Preload.stateWithProducts("main.favoriteProductDetail",{id:product.id},!0,"forward")["catch"](U.error)}function refreshProducts(){var favoriteIds=appStorage.favorites;return Products.getProducts({id:favoriteIds,limit:10,sort:"id DESC",populates:["photos","place"]}).$promise.then(function(productsWrapper){FavoriteProductListModel.products=productsWrapper.products,FavoriteProductListModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.refreshComplete"),U.resize()})}function getOlderProducts(){var favoriteIds=appStorage.favorites;return Products.getProducts({id:favoriteIds,skip:FavoriteProductListModel.products.length,limit:10,sort:"id DESC",populates:["photos","place"]}).$promise.then(function(productsWrapper){angular.forEach(productsWrapper.products,function(product){FavoriteProductListModel.products.push(product)}),FavoriteProductListModel.more=productsWrapper.more})["catch"](U.error)["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete"),U.resize()})}var FavoriteProductList=this;FavoriteProductList.Model=FavoriteProductListModel,FavoriteProductList.refreshProducts=refreshProducts,FavoriteProductList.getOlderProducts=getOlderProducts,FavoriteProductList.preloadToFavoriteProductDetail=preloadToFavoriteProductDetail,$scope.$on("$ionicView.beforeEnter",function(){U.resize()})}angular.module("app").controller("FavoriteProductListController",FavoriteProductListController),FavoriteProductListController.$inject=["Products","U","FavoriteProductListModel","appStorage","$scope","Preload"]}(),function(){"use strict";function FavoriteProductListModel(){var model={products:[],more:!1};return model}angular.module("app").factory("FavoriteProductListModel",FavoriteProductListModel),FavoriteProductListModel.$inject=[]}(),function(){"use strict";function ProductDetailController(U,$scope,Products,ProductDetailModel,Message,$stateParams,FavoriteService,$state,$ionicSlideBoxDelegate,LinkService,Preload){function preloadToPlaceDetail(){Preload.stateWithPlaces("main.placeDetail",{id:ProductDetailModel.market.product.place.id},!0,"forward")}function onBeforeEnter(){U.update(),U.resize()}function onLeave(){U.resetSlides()}var ProductDetail=this;ProductDetail.Model=ProductDetailModel,ProductDetail.isFavorite=FavoriteService.isFavorite,ProductDetail.toggleProduct=FavoriteService.toggleProduct,ProductDetail.call=LinkService.call,ProductDetail.preloadToPlaceDetail=preloadToPlaceDetail,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.beforeLeave",onLeave)}angular.module("app").controller("ProductDetailController",ProductDetailController),ProductDetailController.$inject=["U","$scope","Products","ProductDetailModel","Message","$stateParams","FavoriteService","$state","$ionicSlideBoxDelegate","LinkService","Preload"]}(),function(){"use strict";function ProductDetailModel(){var model={market:{product:{}},pawnShop:{product:{}},product:{}};return model}angular.module("app").factory("ProductDetailModel",ProductDetailModel),ProductDetailModel.$inject=[]}(),function(){"use strict";function ProductListController(U,$scope,Products,ProductListModel,Message,$ionicHistory,$stateParams,$ionicModal,$timeout,$state,AppService,Preload,Dom,appStorage,Photos,$ionicSlideBoxDelegate){function onlyForUser(){return Message.alert("견적요청 알림","일반유저만 견적을 요청할수있습니다.")}function searchProduct(){return Message.loading(),Products.getProductsWithin({category:$state.params.category,longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1],distance:8e3,filter:ProductListModel.searchWord,limit:10,populates:["photos","place"]}).$promise.then(function(productsWrapper){"market"===$state.params.category?(ProductListModel.market.products=productsWrapper.products,ProductListModel.market.more=productsWrapper.more):"pawnShop"===$state.params.category&&(ProductListModel.pawnShop.products=productsWrapper.products,ProductListModel.pawnShop.more=productsWrapper.more),Dom.blurById("search"),Message.hide()})}function preloadToMarket(){return ProductListModel.searchWord=null,Preload.stateWithProducts("main.productList.market",{category:"market"},!0,"back")["catch"](U.error)}function preloadToPawnShop(){return ProductListModel.searchWord=null,Preload.stateWithProducts("main.productList.pawnShop",{category:"pawnShop"},!0,"forward")["catch"](U.error)}function preloadToMarketProductDetail(id){return Preload.stateWithProducts("main.productDetail.market",{category:"market",id:id},!0,"forward")["catch"](U.error)}function preloadToPawnShopProductDetail(id){return Preload.stateWithProducts("main.productDetail.pawnShop",{category:"pawnShop",id:id},!0,"forward")["catch"](U.error)}function refreshProducts(){var category,currentModel,distance,query;return"pawnShop"===$state.params.category?(query={category:"pawnShop",showBid:!0,limit:10,sort:"id DESC",populates:["photos"]},ProductListModel.searchWord&&(query.filter=ProductListModel.searchWord),Products.getProducts(query).$promise.then(function(productsWrapper){ProductListModel.pawnShop.products=productsWrapper.products,ProductListModel.pawnShop.more=productsWrapper.more})["catch"](function(err){return U.error(err)})["finally"](function(){$scope.$broadcast("scroll.refreshComplete")})):"market"===$state.params.category?(distance=appStorage.marketDistance,category="market",currentModel=ProductListModel.market,query={category:category,longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1],distance:distance,status:"selling",limit:10,populates:["photos","place"]},"전체보기"===appStorage.address&&(query.distance=999999,query.sort={_id:-1}),ProductListModel.searchWord&&(query.filter=ProductListModel.searchWord),Products.getProductsWithin(query).$promise.then(function(productsWrapper){return productsWrapper&&productsWrapper.products&&0===productsWrapper.products.length?($scope.$broadcast("scroll.refreshComplete"),Message.alert("새로고침 알림","주위 상품이 없습니다")):(ProductListModel.market.products=productsWrapper.products,ProductListModel.market.more=productsWrapper.more,void U.resize())})["catch"](function(err){return Message.alert()})["finally"](function(){$scope.$broadcast("scroll.refreshComplete")})):void 0}function getFurtherProducts(){var category,currentModel,distance;if("pawnShop"===$state.params.category);else if("market"===$state.params.category){distance=appStorage.marketDistance,category="market",currentModel=ProductListModel.market;var query={category:category,longitude:appStorage.geoJSON.coordinates[0],latitude:appStorage.geoJSON.coordinates[1],distance:distance,limit:10,status:"selling",skip:currentModel.products.length,populates:["photos","place"]};return ProductListModel.searchWord&&(query.filter=ProductListModel.searchWord),Products.getProductsWithin(query).$promise.then(function(productsWrapper){return angular.forEach(productsWrapper.products,function(product){currentModel.products.push(product)}),currentModel.more=productsWrapper.more,U.resize()})["catch"](function(err){return currentModel.more=!1,Message.alert()})["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete")})}}function getOlderPawnShopProducts(){var lastId=ProductListModel.pawnShop.products[ProductListModel.pawnShop.products.length-1].id,query={olderThan:lastId,category:"pawnShop",showBid:!0,limit:10,populates:["photos"]};return ProductListModel.searchWord&&(query.filter=ProductListModel.searchWord),Products.getProducts(query).$promise.then(function(productsWrapper){angular.forEach(productsWrapper.products,function(product){ProductListModel.pawnShop.products.push(product)}),ProductListModel.pawnShop.more=productsWrapper.more})["catch"](function(err){return U.error(err)})["finally"](function(){return U.resize()})}function getNewerProducts(){Products.getProducts({newerThan:ProductListModel.placeId.products[0].id,place:ProductListModel.placeId.products[0].place.id,category:"market",limit:10,populates:["photos"]}).$promise.then(function(productsWrapper){return productsWrapper.products&&0===productsWrapper.products.length?Message.alert("새로고침 알림","주위 상품이 없습니다"):(angular.forEach(productsWrapper.products,function(product){ProductListModel.placeId.products.unshift(product)}),void U.resize())})["catch"](function(err){return Message.alert()})["finally"](function(){$scope.$broadcast("scroll.refreshComplete")})}function getOlderProducts(){var last=ProductListModel.placeId.products.length-1;Products.getProducts({olderThan:ProductListModel.placeId.products[last].id,place:ProductListModel.placeId.products[0].place.id,category:"market",sort:"id DESC",limit:10,populates:["photos"]}).$promise.then(function(productsWrapper){angular.forEach(productsWrapper.products,function(product){ProductListModel.placeId.products.push(product)}),ProductListModel.placeId.more=productsWrapper.more,U.resize()})["catch"](function(err){U.error(err)})["finally"](function(){$scope.$broadcast("scroll.infiniteScrollComplete")})}function onBeforeEnter(){U.resize()}function onAfterEnter(){"pawnShop"===$state.params.category&&Photos.getPhotos({tags:"BANNER"}).$promise.then(function(photos){photos=angular.fromJson(angular.toJson(photos)),ProductListModel.advertisements=photos,$ionicSlideBoxDelegate.update(),ProductList.showPhotos=!0})["catch"](function(err){})}function onAfterLeave(){ProductList.showPhotos=!1}function goToRegisterHandler(){ProductList.beforeRegisterModal.hide(),$timeout(function(){$state.go("main.productRegister.step1",{category:"user",step:1,method:"create"})},100)}var ProductList=this;ProductList.Model=ProductListModel,ProductList.showPhotos=!1,ProductList.searchProduct=searchProduct,ProductList.preloadToMarket=preloadToMarket,ProductList.preloadToPawnShop=preloadToPawnShop,ProductList.refreshProducts=refreshProducts,ProductList.getFurtherProducts=getFurtherProducts,ProductList.preloadToMarketProductDetail=preloadToMarketProductDetail,ProductList.preloadToPawnShopProductDetail=preloadToPawnShopProductDetail,ProductList.getNewerProducts=getNewerProducts,ProductList.getOlderProducts=getOlderProducts,ProductList.getOlderPawnShopProducts=getOlderPawnShopProducts,ProductList.onlyForUser=onlyForUser,ProductList.goToRegisterHandler=goToRegisterHandler,$scope.$on("$ionicView.beforeEnter",function(){U.resize()}),$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter),$scope.$on("$ionicView.afterLeave",onAfterLeave),$ionicModal.fromTemplateUrl("state/10productList/modal/beforeRegisterModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){ProductList.beforeRegisterModal=modal})}angular.module("app").controller("ProductListController",ProductListController),ProductListController.$inject=["U","$scope","Products","ProductListModel","Message","$ionicHistory","$stateParams","$ionicModal","$timeout","$state","AppService","Preload","Dom","appStorage","Photos","$ionicSlideBoxDelegate"]}(),function(){"use strict";function ProductListModel(){var model={market:{products:[]},pawnShop:{products:[]},placeId:{products:[]},location:"",geoJSON:{type:"Point",coordinates:[150,30]},advertisements:[{id:0,photos:[{id:"photo111",url:"img/banner1.png"}],url:"http://naver.com",viewable:!0},{id:1,photos:[{id:"photo111",url:"img/banner2.png"}],url:"http://google.com",viewable:!0},{id:2,photos:[{id:"photo111",url:"img/banner3.png"}],url:"http://google.com",viewable:!0}],products:[],more:!1};return model}angular.module("app").factory("ProductListModel",ProductListModel),ProductListModel.$inject=[]}(),function(){"use strict";function ProductRegisterController($scope,$stateParams,$state,$ionicModal,$timeout,$q,$cordovaGeolocation,U,Products,ProductRegisterModel,Message,ImageService,appStorage,Preload,DaumMapModel){function setCurrentLocation(){return $cordovaGeolocation.getCurrentPosition({maximumAge:1e4,timeout:6e3}).then(function(position){return Message.hide(),null==position.coords?(Message.alert("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요."),!1):(DaumMapModel.currentPosition={latitude:position.coords.latitude,longitude:position.coords.longitude},appStorage.geoJSON.coordinates=[position.coords.longitude,position.coords.latitude],ProductRegisterModel.locationSelected=!0,ProductRegister.stepTwoModal.hide(),void Message.alert("현재위치 알림","현재위치로 장소가 설정되었습니다. 완료버튼을 눌러주세요."))})["catch"](function(err){return Message.alert("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요.")})}function setStepOne(){return ProductRegisterModel.validate()?(ProductRegister.stepOneModal.hide(),$timeout(function(){return $state.go("main.productRegister.step2",{category:$state.params.category,step:2,method:"create"})},150)):!1}function changeLocation(){return ProductRegister.stepTwoModal.hide(),$timeout(function(){return $state.go("main.daumMap",{prev:"main.productRegister.step2"})},150)}function getImage(length,sourceType){ImageService.get({from:sourceType,fileUris:ProductRegisterModel.fileUris,dataUris:ProductRegisterModel.dataUris},length-1)}function validateStep2Form(){return ProductRegisterModel.dataUris[0]?!0:!1}function sendForm(){return validateStep2Form()?"user"===$state.params.category?(Message.loading(),ProductRegister.stepTwoModal.hide(),ProductRegisterModel.form.category="pawnShop",ProductRegisterModel.form.status="pending",ProductRegisterModel.form.geoJSON=appStorage.geoJSON,ImageService.post({url:"/product/byUser",dataUris:ProductRegisterModel.dataUris,fields:ProductRegisterModel.form}).then(function(productDataWrapper){return 0===productDataWrapper.data.numberOfBidsSent?$q.reject(productDataWrapper):Preload.stateWithProducts("main.myProductListUser",{category:"user"},!1)}).then(function(photos){return Message.hide(),ProductRegisterModel.locationSelected=!1,Message.alert("견적등록이 완료 되었습니다.","등록된 견적은 내견적서에서 확인 하실수 있습니다.")}).then(function(alertResponse){return ProductRegisterModel.reset(),U.goToState("main.myProductListUser",{category:"user"})})["catch"](function(err){return 0===err.data.numberOfBidsSent?(Message.hide(),Message.alert("주위에 전당포가 없습니다","지역을 다시 설정해주십시요.").then(U.goToState.bind(null,"main.daumMap"))):(Message.hide(),Message.alert())})):"pawnShop"===$state.params.category?(Message.loading(),ProductRegisterModel.form.category="market",ProductRegisterModel.form.showBid=null,ProductRegisterModel.form.status="selling",ProductRegisterModel.form.place=appStorage.place.id,ProductRegisterModel.form.geoJSON=appStorage.place.geoJSON,ImageService.post({url:"/product",dataUris:ProductRegisterModel.dataUris,fields:ProductRegisterModel.form}).then(function(productData){return Preload.stateWithProducts("main.myProductListPawnShop",{category:"pawnShop"},!1)}).then(function(photos){return Message.hide(),Message.alert("상품이 성공적으로 등록되었습니다","나의 상품목록으로 이동하겠습니다.")}).then(function(alertResponse){return U.goToState("main.myProductListPawnShop",{category:"pawnShop"})})["catch"](function(err){return Message.hide(),Message.alert()})["finally"](function(){return ProductRegisterModel.reset()})):void 0:Message.alert("상품등록 알림","사진을 최소한 1개이상 등록해주셔야합니다.")}var ProductRegister=this;ProductRegister.Model=ProductRegisterModel,ProductRegister.setCurrentLocation=setCurrentLocation,ProductRegister.setStepOne=setStepOne,ProductRegister.changeLocation=changeLocation,ProductRegister.getImage=getImage,ProductRegister.sendForm=sendForm,$ionicModal.fromTemplateUrl("state/10productRegister/modal/stepOneModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){ProductRegister.stepOneModal=modal}),$ionicModal.fromTemplateUrl("state/10productRegister/modal/stepTwoModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){ProductRegister.stepTwoModal=modal}),$ionicModal.fromTemplateUrl("state/10productRegister/modal/completedModal.html",{scope:$scope,animation:"mh-slide"}).then(function(modal){ProductRegister.completedModal=modal})}angular.module("app").controller("ProductRegisterController",ProductRegisterController),ProductRegisterController.$inject=["$scope","$stateParams","$state","$ionicModal","$timeout","$q","$cordovaGeolocation","U","Products","ProductRegisterModel","Message","ImageService","appStorage","Preload","DaumMapModel"]}(),function(){"use strict";function ProductRegisterModel(U,Message,$state){var model={dataUris:[null,null,null,null,null],fileUris:[null,null,null,null,null],form:{name:null,productCategory:null,brand:null,boughtAt:null,price:null,condition:null,showBid:!0,description:null},product:{photos:[],name:null,productCategory:null,brand:null,boughtAt:null,condition:null,showBid:!0,description:null},reset:function(){U.reset(this.form),U.reset(this.product),this.form.showBid=!0,this.product.photos=[],this.dataUris=[null,null,null,null,null],this.fileUris=[null,null,null,null,null]},validate:function(){var form=(Message.alert.bind(null,"상품등록 알림"),this.form);return"user"===$state.params.category?form.name&&form.productCategory&&form.brand&&form.boughtAt&&form.condition?"boolean"!=typeof form.showBid?!1:form.description?!0:!1:!1:"pawnShop"===$state.params.category?form.name&&form.productCategory&&form.brand&&form.boughtAt&&form.condition&&form.description?!0:!1:void 0}};return model}angular.module("app").factory("ProductRegisterModel",ProductRegisterModel),ProductRegisterModel.$inject=["U","Message","$state"]}(),function(){"use strict";function ProductUpdateController(U,$scope,Products,ProductUpdateModel,Message,$state,$ionicModal,$timeout,ImageService,appStorage,Preload){function sendUpdate(){Message.loading(),ProductUpdateModel.form.geoJSON=appStorage.place.geoJSON,ProductUpdateModel.dataUris.length>0&&delete ProductUpdateModel.product.photos,delete ProductUpdateModel.product.$promise,delete ProductUpdateModel.product.$resolved,ImageService.post({url:"/product",dataUris:ProductUpdateModel.dataUris,fields:ProductUpdateModel.product},"PUT").then(function(productData){return Preload.stateWithProducts("main.myProductListPawnShop",{category:"pawnShop"},!1)}).then(function(photos){return Message.hide(),Message.alert("상품이 성공적으로 수정되었습니다","나의 상품목록으로 이동하겠습니다.")}).then(function(){U.goToState("main.myProductListPawnShop",{category:"pawnShop"}),U.reset(ProductUpdateModel.product),U.reset(ProductUpdateModel.dataUris),U.reset(ProductUpdateModel.fileUris)})["catch"](function(err){Message.alert(),U.reset(ProductUpdateModel.product),U.reset(ProductUpdateModel.dataUris),U.reset(ProductUpdateModel.fileUris)})}function onBeforeEnter(){U.resize()}var ProductUpdate=this;ProductUpdate.Model=ProductUpdateModel,ProductUpdate.sendUpdate=sendUpdate,$scope.$on("$ionicView.beforeEnter",onBeforeEnter)}angular.module("app").controller("ProductUpdateController",ProductUpdateController),ProductUpdateController.$inject=["U","$scope","Products","ProductUpdateModel","Message","$state","$ionicModal","$timeout","ImageService","appStorage","Preload"]}(),function(){"use strict";function ProductUpdateModel(){var model={dataUris:[],fileUris:[],form:{name:null,productCategory:null,brand:null,boughtAt:null,price:null,condition:null,showBid:!0,description:null},product:{photos:[],name:null,productCategory:null,brand:null,boughtAt:null,price:null,condition:null,showBid:!0,description:null}};return model}angular.module("app").factory("ProductUpdateModel",ProductUpdateModel),ProductUpdateModel.$inject=[]}(),function(){"use strict";function PostDetailController(PostDetailModel){var PostDetail=this;PostDetail.Model=PostDetailModel}angular.module("app").controller("PostDetailController",PostDetailController),PostDetailController.$inject=["PostDetailModel"]}(),function(){"use strict";function PostDetailModel(){var model={market:{product:{}},pawnShop:{product:{}}};return model}angular.module("app").factory("PostDetailModel",PostDetailModel),PostDetailModel.$inject=[]}(),function(){"use strict";function PostListController(PostListModel){var PostList=this;PostList.Model=PostListModel}angular.module("app").controller("PostListController",PostListController),PostListController.$inject=["PostListModel"]}(),function(){"use strict";function PostListModel(){var model={};return model}angular.module("app").factory("PostListModel",PostListModel),PostListModel.$inject=[]}(),function(){"use strict";function AnnouncementDetailController($scope,AnnouncementDetailModel,Posts,Message,U,Preload,$q,$state){function onBeforeEnter(){AnnouncementDetailModel.loading=!0}function onAfterEnter(){return findOne().then(function(post){U.bindData(post,AnnouncementDetailModel,"post")})["catch"](U.error)}function refresh(){return findOne().then(function(post){U.bindData(post,AnnouncementDetailModel,"post")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function findOne(extraQuery){var query={id:$state.params.id};return angular.extend(query,extraQuery),Posts.findOne(query).$promise.then(function(post){var photosPromise=Preload.photos(post,"cloudinary200",!1);return $q.all([post,photosPromise])}).then(function(array){var post=array[0];return post})}var AnnouncementDetail=this;AnnouncementDetail.Model=AnnouncementDetailModel,AnnouncementDetail.refresh=refresh,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("AnnouncementDetailController",AnnouncementDetailController),AnnouncementDetailController.$inject=["$scope","AnnouncementDetailModel","Posts","Message","U","Preload","$q","$state"];
}(),function(){"use strict";function AnnouncementDetailModel(){var model={post:{title:"test",content:"test test",createdAt:null}};return model}angular.module("app").factory("AnnouncementDetailModel",AnnouncementDetailModel),AnnouncementDetailModel.$inject=[]}(),function(){"use strict";function AnnouncementListController($scope,AnnouncementListModel,Posts,Message,U,Preload,$q){function onBeforeEnter(){U.areSiblingViews(noLoadingStates)||(AnnouncementListModel.loading=!0)}function onAfterEnter(){return U.areSiblingViews(noLoadingStates)?void 0:find().then(function(postsWrapper){U.bindData(postsWrapper,AnnouncementListModel,"posts")})["catch"](U.error)}function refresh(){return find().then(function(postsWrapper){U.bindData(postsWrapper,AnnouncementListModel,"posts")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function loadMore(){var last=AnnouncementListModel.posts.length-1;return find({olderThan:AnnouncementListModel.posts[last]}).then(function(postsWrapper){U.appendData(postsWrapper,AnnouncementListModel,"posts")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function find(extraQuery){var query={category:"notification",limit:20,sort:"id DESC"};return angular.extend(query,extraQuery),Posts.find(query).$promise.then(function(postsWrapper){var photosPromise=Preload.photos(postsWrapper.posts,"cloudinary200",!0);return $q.all([postsWrapper,photosPromise])}).then(function(array){var postsWrapper=array[0];return postsWrapper})}var AnnouncementList=this;AnnouncementList.Model=AnnouncementListModel;var noLoadingStates=["main.announcementDetail"];AnnouncementList.refresh=refresh,AnnouncementList.loadMore=loadMore,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("AnnouncementListController",AnnouncementListController),AnnouncementListController.$inject=["$scope","AnnouncementListModel","Posts","Message","U","Preload","$q"]}(),function(){"use strict";function AnnouncementListModel(){var model={posts:[{id:"test1",title:"첫번째 공지사항",createdAt:new Date},{id:"test2",title:"두번째 공지사항",createdAt:new Date}],more:!1};return model}angular.module("app").factory("AnnouncementListModel",AnnouncementListModel),AnnouncementListModel.$inject=[]}(),function(){"use strict";function FaqDetailController($scope,FaqDetailModel,Posts,Message,U,Preload,$q,$state){function onBeforeEnter(){FaqDetailModel.loading=!0}function onAfterEnter(){return findOne().then(function(post){U.bindData(post,FaqDetailModel,"post")})["catch"](U.error)}function refresh(){return findOne().then(function(post){U.bindData(post,FaqDetailModel,"post")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function findOne(extraQuery){var query={id:$state.params.id};return angular.extend(query,extraQuery),Posts.findOne(query).$promise.then(function(post){var photosPromise=Preload.photos(post,"cloudinary200",!0);return $q.all([post,photosPromise])}).then(function(array){var post=array[0];return post})}var FaqDetail=this;FaqDetail.Model=FaqDetailModel,FaqDetail.refresh=refresh,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("FaqDetailController",FaqDetailController),FaqDetailController.$inject=["$scope","FaqDetailModel","Posts","Message","U","Preload","$q","$state"]}(),function(){"use strict";function FaqDetailModel(){var model={post:{title:"test",content:"test test",createdAt:null}};return model}angular.module("app").factory("FaqDetailModel",FaqDetailModel),FaqDetailModel.$inject=[]}(),function(){"use strict";function FaqListController($scope,FaqListModel,Posts,Message,U,Preload,$q){function onBeforeEnter(){U.areSiblingViews(noLoadingStates)||(FaqListModel.loading=!0)}function onAfterEnter(){return U.areSiblingViews(noLoadingStates)?void 0:find().then(function(postsWrapper){U.bindData(postsWrapper,FaqListModel,"posts")})["catch"](U.error)}function refresh(){return find().then(function(postsWrapper){U.bindData(postsWrapper,FaqListModel,"posts")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function loadMore(){var last=FaqListModel.posts.length-1;return find({olderThan:FaqListModel.posts[last]}).then(function(postsWrapper){U.appendData(postsWrapper,FaqListModel,"posts")})["catch"](U.error)["finally"](function(){U.broadcast($scope)})}function find(extraQuery){var query={category:"faq",limit:20,sort:"id DESC"};return angular.extend(query,extraQuery),Posts.find(query).$promise.then(function(postsWrapper){var photosPromise=Preload.photos(postsWrapper.posts,"cloudinary200",!0);return $q.all([postsWrapper,photosPromise])}).then(function(array){var postsWrapper=array[0];return postsWrapper})}var FaqList=this;FaqList.Model=FaqListModel;var noLoadingStates=["main.faqDetail"];FaqList.refresh=refresh,FaqList.loadMore=loadMore,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter)}angular.module("app").controller("FaqListController",FaqListController),FaqListController.$inject=["$scope","FaqListModel","Posts","Message","U","Preload","$q"]}(),function(){"use strict";function FaqListModel(){var model={posts:[{title:"첫번째 공지사항"},{title:"두번째 공지사항"}],more:!1};return model}angular.module("app").factory("FaqListModel",FaqListModel),FaqListModel.$inject=[]}(),function(){"use strict";function PlaceDetailController(U,$scope,Places,PlaceDetailModel,Message,$stateParams,FavoriteService,DaumMapModel,Preload){function pinSelectedPlace(){var longitude=PlaceDetailModel.place.geoJSON.coordinates[0],latitude=PlaceDetailModel.place.geoJSON.coordinates[1];DaumMapModel.selectedPlace.longitude=longitude,DaumMapModel.selectedPlace.latitude=latitude,U.goToState("main.daumMap",{id:PlaceDetailModel.place.id})}function preloadToProductListByPlace(){Preload.stateWithProducts("main.placeId",{id:PlaceDetailModel.place.id,category:"market"},!0,"forward")}function onBeforeEnter(){U.update()}function onLeave(){U.resetSlides()}var PlaceDetail=this;PlaceDetail.Model=PlaceDetailModel,PlaceDetail.isFavorite=FavoriteService.isFavorite,PlaceDetail.togglePlace=FavoriteService.togglePlace,PlaceDetail.pinSelectedPlace=pinSelectedPlace,PlaceDetail.preloadToProductListByPlace=preloadToProductListByPlace,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.leave",onLeave)}angular.module("app").controller("PlaceDetailController",PlaceDetailController),PlaceDetailController.$inject=["U","$scope","Places","PlaceDetailModel","Message","$stateParams","FavoriteService","DaumMapModel","Preload"]}(),function(){"use strict";function PlaceDetailModel(){var model={place:{name:"착한 전당포",photos:[],address:"서울특별시 강남구 역삼동 123123123 123123 123123",cellPhone:"01012341234",phone:"021231231",openingHours:"",canPickUp:!0,showPhone:!0,description:"전자제품 취급합니다. \n 컴퓨터 / 패드 / 핸드폰 등 여러 전자제품 취급합니다."}};return model}angular.module("app").factory("PlaceDetailModel",PlaceDetailModel),PlaceDetailModel.$inject=[]}(),function(){"use strict";function PlaceListController($scope,PlaceListModel,U){function onBeforeEnter(){U.resize()}function onAfterEnter(){PlaceList.showPhotos=!0}function onAfterLeave(){PlaceList.showPhotos=!1}var PlaceList=this;PlaceList.Model=PlaceListModel,PlaceList.showPhotos=!1,$scope.$on("$ionicView.beforeEnter",onBeforeEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter),$scope.$on("$ionicView.afterLeave",onAfterLeave)}angular.module("app").controller("PlaceListController",PlaceListController),PlaceListController.$inject=["$scope","PlaceListModel","U"]}(),function(){"use strict";function PlaceListModel(){var model={places:[]};return model}angular.module("app").factory("PlaceListModel",PlaceListModel),PlaceListModel.$inject=[]}(),function(){"use strict";function DaumMapController($ionicModal,$scope,$state,$stateParams,$timeout,DaumMapModel,Message,appStorage,Preload,ProductRegisterModel){function setAppStorage(){var longitude=DaumMapModel.currentPosition.longitude,latitude=DaumMapModel.currentPosition.latitude;return appStorage.geoJSON.coordinates[0]=longitude,appStorage.geoJSON.coordinates[1]=latitude,"main.productRegister.step2"===$state.params.prev?(ProductRegisterModel.locationSelected=!0,$state.go("main.productRegister.step2",{category:"user",method:"create",step:2})):Preload.stateWithProducts("main.productList.market",{category:"market"},!0,"forward")}function onEnter(){}function onAfterEnter(){$timeout(function(){DaumMapModel.domMap.relayout(),$state.params.id&&DaumMapModel.pinSelectedPlace()},10)}function onAfterLeave(){$state.params.id&&DaumMapModel.unPinSelectedPlace()}var DaumMap=this;DaumMap.Model=DaumMapModel,DaumMap.searchType="address",DaumMap.findMeThenSearchNearBy=DaumMapModel.findMeThenSearchNearBy,DaumMap.searchLocationNearBy=DaumMapModel.searchLocationNearBy,DaumMap.setAppStorage=setAppStorage,$scope.$on("$ionicView.enter",onEnter),$scope.$on("$ionicView.afterEnter",onAfterEnter),$scope.$on("$ionicView.afterLeave",onAfterLeave),$ionicModal.fromTemplateUrl("state/20daumMap/placeModal.html",{scope:$scope,animation:"slide-in-up"}).then(function(modal){DaumMapModel.modal=modal})}angular.module("app").controller("DaumMapController",DaumMapController),DaumMapController.$inject=["$ionicModal","$scope","$state","$stateParams","$timeout","DaumMapModel","Message","appStorage","Preload","ProductRegisterModel"]}(),function(){"use strict";function daumMap(DaumMapModel,Places,Bookings,Products,$state,$cordovaGeolocation,$geolocation,Message,$q,$stateParams,daum,appStorage){return{scope:{markerSrc:"@",markerClickedSrc:"@",markerWidth:"@",markerHeight:"@"},compile:function(element){function findMeThenSearchNearBy(){Message.loading(),$cordovaGeolocation.getCurrentPosition({maximumAge:1e4,timeout:6e3}).then(function(position){return Message.hide(),null==position.coords?(Message.alert("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요."),!1):(DaumMapModel.currentPosition={latitude:position.coords.latitude,longitude:position.coords.longitude},void map.setCenter(new daum.maps.LatLng(DaumMapModel.currentPosition.latitude,DaumMapModel.currentPosition.longitude)))})["catch"](function(err){return Message.alert("위치 공유가 꺼져있습니다.","위치 공유를 켜주세요.")})["finally"](function(){return Message.hide()})}function searchLocationNearBy(value){return Message.loading(),value?void ps.keywordSearch(value,function(status,data){return void 0===data.places[0]?(Message.hide(),Message.alert("요청하신 장소가 없습니다","다시검색해주세요"),!1):(map.panTo(new daum.maps.LatLng(data.places[0].latitude,data.places[0].longitude)),DaumMapModel.currentPosition={latitude:data.places[0].latitude,longitude:data.places[0].longitude},void Message.hide())},function(err){Message.hide(),Message.alert({title:"위치 공유가 꺼져있습니다.",template:"위치 공유 켜주세요."})}):(Message.hide(),Message.alert("검색하기 알림","장소 값을 넣어서 다시 검색해주세요"),!1)}function pinSelectedPlace(){var longitude=DaumMapModel.selectedPlace.longitude,latitude=DaumMapModel.selectedPlace.latitude;DaumMapModel.placeIdMarker=new daum.maps.Marker({position:new daum.maps.LatLng(latitude,longitude)}),DaumMapModel.placeIdMarker.setMap(map),map.panTo(new daum.maps.LatLng(latitude,longitude))}function unPinSelectedPlace(){DaumMapModel.placeIdMarker.setMap(null)}var latitude=appStorage.geoJSON.coordinates[1]||DaumMapModel.currentPosition.latitude||37.498085435791786,longitude=appStorage.geoJSON.coordinates[0]||DaumMapModel.currentPosition.longitude||127.02800027507125,DOM=element[0],mapOptions={center:new daum.maps.LatLng(latitude,longitude),level:4,draggable:!0};daum.maps.disableHD();var map=new daum.maps.Map(DOM,mapOptions),ps=new daum.maps.services.Places,geocoder=new daum.maps.services.Geocoder;return DaumMapModel.findMeThenSearchNearBy=findMeThenSearchNearBy,DaumMapModel.searchLocationNearBy=searchLocationNearBy,DaumMapModel.pinSelectedPlace=pinSelectedPlace,DaumMapModel.unPinSelectedPlace=unPinSelectedPlace,DaumMapModel.marker=null,DaumMapModel.placeIdMarker=null,function(scope){var markerSize=new daum.maps.Size(Number(scope.markerWidth),Number(scope.markerHeight)),markerImg=new daum.maps.MarkerImage(scope.markerSrc,markerSize);map.relayout(),DaumMapModel.domMap=map,daum.maps.event.addListener(map,"click",function(mouseEvent){return $state.params.id?!1:(geocoder.coord2addr(mouseEvent.latLng,function(status,result){appStorage.address=result[0].fullName}),DaumMapModel.marker&&DaumMapModel.marker.setMap(null),DaumMapModel.marker=new daum.maps.Marker({position:mouseEvent.latLng,image:markerImg}),DaumMapModel.marker.setMap(map),DaumMapModel.marker.setDraggable(!0),void(DaumMapModel.currentPosition={latitude:mouseEvent.latLng.getLat(),longitude:mouseEvent.latLng.getLng()}))})}}}}angular.module("app").directive("daumMap",daumMap),daumMap.$inject=["DaumMapModel","Places","Bookings","Products","$state","$cordovaGeolocation","$geolocation","Message","$q","$stateParams","daum","appStorage"]}(),function(){"use strict";function DaumMapModel(){var model={currentPosition:{latitude:37.498085435791786,longitude:127.02800027507125},markers:[],places:[],selectedPlace:{},modal:{},findMeThenSearchNearBy:function(){},searchLocationNearBy:function(){},pinSelectedPlace:function(){},unPinSelectedPlace:function(){}};return model}angular.module("app").factory("DaumMapModel",DaumMapModel)}();